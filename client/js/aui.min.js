/*
  Dynamic Suite: AUI
  License: GPLv3
*/
Vue.component("aui-alert",{template:'<div v-if="visible" class="aui alert" :class="container_class"><div><h3 v-if="title">{{title}}</h3><p><slot></slot></p></div><i v-if="closeable" class="fa fa-times close" @click="$emit(\'close\')"></i></div>',props:{type:{type:String,default:"primary",validator:e=>-1!==["none","primary","secondary","success","warning","failure"].indexOf(e)},title:{type:String},visible:{type:Boolean|String,default:!0},closeable:{type:Boolean,default:!1}},computed:{container_class(){return"none"===this.type?"":"alert-"+this.type}}});
Vue.component("aui-badge",{template:'<span class="aui badge" :class="badge_class" v-html="content"></span>',props:{type:{type:String,default:"primary",validator:e=>-1!==["none","primary","secondary","success","warning","failure"].indexOf(e)},content:{type:String|Number,required:!0}},computed:{badge_class(){return"none"===this.type?"":"badge-"+this.type}}});
Vue.component("aui-button",{template:'<button class="aui btn" :class="(type !== \'none\' ? \'btn-\' + type : \'\')" :disabled="is_disabled" @click="$emit(\'click\')"><span v-if="isDelayed()"><i class="fa fa-spin fa-circle-notch"></i><span v-if="has_loading_text" class="loading-text">{{loading_text}}</span><slot v-else></slot></span><slot v-else>{{text}}</slot><aui-badge type="failure" v-if="alert" :content="alert_content"></aui-badge></button>',props:{type:{type:String,default:"primary",validator:t=>-1!==["primary","secondary","success","warning","failure","none"].indexOf(t)},text:{type:null|String,default:null},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loading_text:{type:String,default:null},alert:{type:Boolean,default:!1},alert_content:{type:String,default:"!"}},data:()=>({show_spinner:!1,default_class:!1}),computed:{has_loading_text(){return"string"==typeof this.loading_text},is_disabled(){return this.loading||this.disabled}},methods:{isDelayed(){return this.loading?setTimeout(()=>{this.loading&&(this.show_spinner=!0)},100):this.show_spinner=!1,this.show_spinner}}});
Vue.component("aui-button-drop",{template:'<div class="aui btn-drop" ref="dropdown"><button class="aui btn" :class="button_classes" :disabled="is_disabled" @click="toggle"><span v-if="$slots.default"><slot></slot></span><i :class="icon_class"></i></button><ul v-show="show_dropdown" class="dropdown" ref="menu" :class="list_classes"><li v-for="entry in dropdown" @click="runAction(entry.action)">{{entry.label}}</li></ul></div>',props:{type:{type:String,default:"primary",validator:t=>-1!==["none","primary","secondary","success","warning","failure"].indexOf(t)},dropdown:{type:Array,required:!0,validator(t){for(let e=0;e<t.length;e++){if("string"!=typeof t[e].label)return!1;if("function"!=typeof t[e].action&&"string"!=typeof t[e].action)return!1}return!0}},disabled:{type:Boolean,default:!1},icon_inactive:{type:String,default:"fas fa-caret-down"},icon_active:{type:String,default:"fas fa-caret-up"},menu_align:{type:String,default:"left",validator:t=>-1!==["left","right"].indexOf(t)},relative_to:{type:null|String,default:null}},computed:{button_classes(){let t={active:this.show_dropdown};return"none"!==this.type&&(t["btn-"+this.type]=!0),t},icon_class(){return this.show_dropdown?this.icon_active:this.icon_inactive},list_classes(){let t={top:this.anchor_top};return t[this.menu_align_master]=!!this.menu_align_master,t[this.menu_align]=!this.menu_align_master,t},is_disabled(){return this.loading||this.disabled}},data:()=>({show_dropdown:!1,anchor_top:!1,menu_align_master:null}),methods:{toggle(){this.show_dropdown=!this.show_dropdown,this.menu_align_master=null,this.anchor_top=!1,Vue.nextTick(()=>{this.$refs.menu.style.opacity="0";const t=this.$refs.menu.getBoundingClientRect();let e=window.innerHeight-t.bottom,i=window.innerWidth-t.right;if(this.relative_to){const n=this.$refs.menu.closest(this.relative_to);n&&(e=n.offsetHeight-t.bottom,i=n.offsetWidth-t.right)}i<0&&(this.menu_align_master="right"),e<0&&(this.anchor_top=!0),this.$refs.menu.style.opacity="1"})},outsideReset(t){this.$refs.dropdown.contains(t.target)||(this.show_dropdown=!1)},runAction(t){"function"==typeof t?t():window.open(t),this.show_dropdown=!1}},created(){window.addEventListener("click",this.outsideReset)},beforeDestroy(){window.removeEventListener("click",this.outsideReset)}});
Vue.component("aui-card",{template:'<div class="aui card" :class="card_class"><h1>{{header}}</h1><div class="body"><h2 v-if="title">{{title}}</h2><p class="card-text"><slot></slot></p></div></div>',props:{type:{type:String,default:"primary",validator:e=>-1!==["none","neutral","primary","secondary","success","warning","failure"].indexOf(e)},header:{type:String,required:!0},title:{type:String}},computed:{card_class(){return"none"===this.type?"":"card-"+this.type}}});
Vue.component("aui-checkbox",{template:'<label class="aui checkbox" :class="true ? \'disabled\' : \'not-disabled\'"><slot></slot><input type="checkbox" :checked="checked" :disabled="disabled" @change="$emit(\'input\', $event.target.checked)"><span class="checkmark"></span></label>',props:{checked:{type:Boolean|Number,default:!1},disabled:{type:Boolean,default:!1}}});
Vue.component("aui-crud",{template:'<div class="aui crud"><aui-notice v-if="show_error" type="failure" icon="fas fa-exclamation-triangle" text="A server error has occurred" subtext="Please reload the page" /><aui-notice v-if="show_created_confirmation" type="success" icon="fas fa-check-circle" :text="form_created_confirmation_text" /><div v-if="show_list" class="list"><div class="header"><div class="title"><h2><slot name="list-title">CRUD List</slot></h2></div><div class="action"><slot name="list-buttons"></slot><aui-button v-if="list_show_create_button" :disabled="state.overlay" @click="setupCreate"><i class="fas fa-plus"></i></aui-button><aui-input v-if="list_show_search" placeholder="Search" :disabled="state.overlay" v-model="list.search" @input="runSearch" /></div></div><div class="data"><aui-notice v-if="!has_list_data && !state.calling" :icon="list_empty_icon" :text="list_empty_text" :subtext="list_empty_subtext" /><div v-if="state.overlay" :class="list_overlay_classes"><aui-notice :icon="list_overlay_icon" :text="list_overlay_text" :subtext="list_overlay_subtext" /></div><aui-list-group v-if="list_is_group" :rows="list_group_data" /><table v-if="list_is_table" :class="list_table_classes"><thead><tr><th v-for="(column, key) in list_table_columns" :key="key + \'-header\'" @click="sortList(key)">{{column}}<i v-if="isSortedAsc(key)" class="fas fa-sort-amount-down-alt"></i><i v-else-if="isSortedDesc(key)" class="fas fa-sort-amount-down"></i><i v-else class="fas fa-sort"></i></th></tr></thead><tbody><tr v-for="(row, key) in list_table_data" :key="key + \'-row\'" @click="emitListClick(row.id)"><td v-for="(column, col_key) in row.data" :key="col_key + \'-column\'">{{column}}</td></tr></tbody></table></div><div v-if="has_list_data" class="pagination"><div class="range"><span>Showing</span><label><select v-model="list.limit" :disabled="state.overlay" @change="readList"><option v-for="limit in list_range_limit" :key="limit + \'-page-limit\'" :value="limit">{{limit}}</option></select></label><span>from {{list.from.toLocaleString()}} to {{list.to.toLocaleString()}} of {{list.total.toLocaleString()}}</span></div><div class="buttons"><aui-button type="secondary" class="chevron" :disabled="state.overlay" @click="stepPageFirst">&laquo;</aui-button><aui-button type="secondary" class="chevron" :disabled="state.overlay" @click="stepPagePrevious">&lsaquo;</aui-button><aui-button v-for="(page, key) in list.range" :key="key + \'-pagination\'" :type="paginateButtonType(page)" :text="page" :disabled="state.overlay" class="page-button" @click="paginate(page)" /><aui-button type="secondary" class="chevron" :disabled="state.overlay" @click="stepPageNext">&rsaquo;</aui-button><aui-button type="secondary" class="chevron" :disabled="state.overlay" @click="stepPageLast">&raquo;</aui-button></div></div></div><div v-if="show_form" class="form"><aui-tabs v-if="view_show_tabs" :tabs="view_tabs" :initial_tab="tab_id" @change="changeTab" /><div class="body" v-for="(view, key) in form_views" :key="\'view-\' + key"><slot v-if="isActiveTab(view.name)" :name="view.name" :tab="tab" :form="form" :error="error.form" :calling="state.calling" :overlay="state.overlay" :showForm="showForm" :runCreate="runCreate" :runUpdate="runUpdate" :runDelete="runDelete" :closeModals="closeModals"></slot></div><div v-if="view_show_action_bar" class="action"><aui-button type="secondary" :disabled="state.overlay" text="Back" @click="showForm(false, true)" /><div class="primary"><i v-if="state.show_failure_tick" class="tic fas fa-times"></i><i v-if="state.show_success_tick" class="tic fas fa-check"></i><aui-button v-if="!created" :loading="state.overlay" loading_text="Creating..." text="Create" @click="runCreate" /><div v-else class="btn-group"><aui-button :loading="form_update_is_running" loading_text="Updating..." text="Update" @click="runUpdate" /><aui-button-drop :dropdown="form_delete_dropdown" :disabled="state.overlay" /></div></div></div><aui-modal type="failure" title="Confirm Delete" :show="state.show_delete_modal" @close="closeModals"><slot name="confirm-delete" :tab="tab" :form="form" :error="error.form" :warning="error.delete_protect" :calling="state.calling" :overlay="state.overlay" :showForm="showForm" :runCreate="runCreate" :runUpdate="runUpdate" :runDelete="runDelete" :closeModals="closeModals"><p class="delete-text">{{form_delete_text}}</p><aui-alert v-if="error.delete_protect" type="failure">{{error.delete_protect}}</aui-alert><div class="action"><aui-button type="secondary" :disabled="state.overlay" text="Cancel" @click="closeModals" /><div class="primary"><aui-button type="failure" :loading="state.overlay" loading_text="Deleting..." text="Delete" @click="runDelete(true)" /></div></div></slot></aui-modal></div></div>',props:{package:{type:String,required:!0},list_type:{type:String,default:"group",validator:t=>-1!==["group","table"].indexOf(t)},list_can_go_to_form:{type:Boolean,default:!0},list_interactive:{type:Boolean,default:!0},list_table_columns:{type:Object,default:()=>({id:"ID"}),validator:t=>{for(const e in t)if("string"!=typeof t[e])return!1;return!0}},list_empty_icon:{type:String,default:"fas fa-ban"},list_empty_text:{type:null|String,default:"No data found"},list_empty_subtext:{type:null|String,default:null},list_overlay_icon:{type:String,default:"fas fa-circle-notch fa-spin"},list_overlay_text:{type:null|String,default:null},list_overlay_subtext:{type:null|String,default:null},list_show_create_button:{type:Boolean,default:!0},list_show_search:{type:Boolean,default:!0},list_range_limit:{type:Array,default:()=>[15,25,50,100]},list_api_read:{type:String,required:!0},list_api_read_optional_data:{type:Object,default:()=>{}},form_api_read:{type:String},form_api_read_optional_data:{type:Object,default:()=>{}},form_api_create:{type:String},form_api_create_optional_data:{type:Object,default:()=>{}},form_api_update:{type:String},form_api_update_optional_data:{type:Object,default:()=>{}},form_api_delete:{type:String},form_api_delete_optional_data:{type:Object,default:()=>{}},form_created_confirmation_text:{type:String,default:"Created"},form_storable_key:{type:String,default:"id"},form_delete_text:{type:String,default:"Are you sure you want to delete?"},fields:{type:Array,default:()=>[],validator:t=>{for(const e of t)if("string"!=typeof e)return!1;return!0}},views:{type:Array,default:()=>[],validator:t=>{for(const e of t){if("string"!=typeof e&&"object"!=typeof e)return!1;if("object"==typeof e)for(const t in e){if("name"===t&&"string"!=typeof e[t])return!1;if("tab_name"===t&&"string"!=typeof e[t])return!1;if("show_action_bar"===t&&"boolean"!=typeof e[t])return!1}}return!0}}},data(){return{list:{data:[],limit:0,from:0,to:0,total:0,pages:0,page:1,search_timer:null,search:null,range:[],sort:{},sort_order:[]},created:!1,tab:null,tab_id:null,form:{},form_delete_dropdown:[{label:"Delete",action:()=>{this.runDelete()}}],state:{calling:!1,overlay:!1,show_form:!1,show_delete_modal:!1,show_failure_tick:!1,show_success_tick:!1,show_created_confirmation:!1},error:{server:!1,delete_protect:null,form:{}}}},computed:{show_error(){return this.error.server},show_list(){return!this.error.server&&!this.state.show_form&&!this.state.show_created_confirmation},show_form(){return!this.error.server&&this.state.show_form&&!this.state.show_created_confirmation},show_created_confirmation(){return!this.error.server&&this.state.show_created_confirmation},has_list_data(){return this.list.data.length>0},list_is_group(){return this.has_list_data&&"group"===this.list_type},list_is_table(){return this.has_list_data&&"table"===this.list_type},list_group_data(){const t=[];if("group"!==this.list_type)return t;for(const e of this.list.data)t.push({icon:e.icon?e.icon:"",title:e.title,subtext:e.subtext,action:()=>this.emitListClick(e.id)});return t},list_table_data(){const t=[];if("table"!==this.list_type)return t;for(const e of this.list.data){const i={id:e.id,data:{}};for(const t in this.list_table_columns)void 0!==e[t]&&(i.data[t]=e[t]);t.push(i)}return t},list_overlay_classes(){return{overlay:!0,empty:this.list.data.length<=0}},list_table_classes(){return{interactive:this.list_interactive||this.list_can_go_to_form}},form_views(){const t=[];for(const e in this.views){let i={name:null,tab_name:null,show_action_bar:!0};if("string"==typeof this.views[e])i.name=this.views[e],i.tab_name=this.views[e];else for(const t in this.views[e])i[t]=this.views[e][t];t.push(i)}return t},form_update_is_running(){return this.state.overlay&&!this.state.show_delete_modal},view_show_tabs(){return this.form_views.length>1&&this.created},view_tabs(){const t={};for(const e in this.form_views)t[e]=this.form_views[e].tab_name;return t},view_show_action_bar(){return this.form_views[this.tab_id].show_action_bar}},watch:{"state.calling":{handler:function(t){t?setTimeout(()=>{this.state.calling&&(this.state.overlay=!0)},100):this.state.overlay=!1}}},methods:{readList(){if(this.state.calling)return;const t=Object.assign({type:this.list_type,page:this.list.page,limit:this.list.limit,search:this.list.search,sort:this.list.sort,sort_order:this.list.sort_order},this.list_api_read_optional_data);this.state.calling=!0,DynamicSuite.call(this.package,this.list_api_read,t,t=>{switch(t.status){case"OK":this.list.data=t.data.list,this.list.total=t.data.total,this.list.pages=Math.ceil(this.list.total/this.list.limit);let e=(this.list.page-1)*this.list.limit;e>this.list.total&&(e=this.list.total-this.list.limit,this.list.page=this.list.pages),this.list.from=e+1,this.list.to=this.list.from+this.list.limit-1,this.list.to>this.list.total&&(this.list.to=this.list.total),this.updatePaginationRange(),this.state.calling=!1,this.$emit("read-list");break;default:this.error.server=!0}})},runSearch(){clearTimeout(this.list.search_timer),this.list.search_timer=setTimeout(()=>{this.paginate(1,!0),this.$emit("search",this.list.search)},300)},sortList(t){void 0===this.list.sort[t]?(this.list.sort_order.push(t),this.$set(this.list.sort,t,"ASC"),this.$emit("sort-asc",t)):"ASC"===this.list.sort[t]?(this.$set(this.list.sort,t,"DESC"),this.$emit("sort-desc",t)):(this.list.sort_order.splice(this.list.sort_order.indexOf(t),1),this.$delete(this.list.sort,t),this.$emit("sort-clear",t)),this.paginate(1,!0)},isSortedAsc(t){return void 0!==this.list.sort[t]&&"ASC"===this.list.sort[t]},isSortedDesc(t){return void 0!==this.list.sort[t]&&"DESC"===this.list.sort[t]},emitListClick(t){this.$emit("list-click",t)},updatePaginationRange(){const t=[];if(this.list.pages<5)for(let e=1;e<=this.list.pages;e++)t.push(e);else if(this.list.page<3)for(let e=1;e<=5;e++)t.push(e);else{const e=this.list.page+2>this.list.pages,i=e?this.list.pages:this.list.page+2;for(let s=e?this.list.pages-4:this.list.page-2;s<=i;s++)t.push(s)}this.list.range=t},paginateButtonType(t){return this.list.page===parseInt(t)?"primary":"secondary"},paginate(t,e=!1){(parseInt(t)!==this.list.page||e)&&(this.list.page=parseInt(t),this.readList(),this.$emit("paginate",t))},stepPageFirst(){1!==this.list.page&&(this.paginate(1),this.$emit("paginate-first"))},stepPagePrevious(){if(1===this.list.page)return;const t=this.list.page-1;t>0&&(this.paginate(t),this.$emit("paginate-previous"))},stepPageNext(){if(this.list.page===this.list.pages)return;const t=this.list.page+1;t<=this.list.pages&&(this.paginate(t),this.$emit("paginate-next"))},stepPageLast(){this.list.page!==this.list.pages&&(this.paginate(this.list.pages),this.$emit("paginate-last"))},loadFields(){this.form={},this.error.form={};for(const t of this.fields)this.$set(this.form,t,null),this.$set(this.error.form,t,null)},showForm(t,e=!1){t?this.$emit("show-form"):(this.loadFields(),this.tab=this.form_views[0].name,this.tab_id=0,this.readList(),this.$emit("show-list")),this.state.show_form=t,e&&this.setURIState()},setupCreate(){this.created=!1,this.loadFields(),this.resetFormFeedback(),this.showForm(!0,!0),this.$emit("setup-create")},isActiveTab(t){return null===this.tab&&(this.tab=this.form_views[0].name,this.tab_id=0),t===this.tab},changeTab(t){this.tab=this.form_views[t].name,this.tab_id=t,this.setURIState(),this.$emit("tab-changed",{tab:this.form_views[t].name,tab_id:t})},readStorable(t,e=!0){if(this.state.calling)return;this.loadFields();const i=Object.assign({id:t},this.form_api_read_optional_data);this.state.calling=!0,DynamicSuite.call(this.package,this.form_api_read,i,i=>{switch(i.status){case"OK":for(const t in i.data)this.$set(this.form,t,i.data[t]);this.resetFormFeedback(),this.showForm(!0,!1),this.created=!0,this.state.calling=!1,e&&this.setURIState(),this.$emit("read-form",t);break;default:this.clearURIState(),this.error.server=!0}})},resetFormFeedback(){this.state.show_failure_tick=!1,this.state.show_success_tick=!1,this.error.delete_protect=null;for(const t in this.error.form)this.error.form[t]=null},runCreate(){if(this.state.calling)return;this.resetFormFeedback();const t=Object.assign({},this.form,this.form_api_create_optional_data);this.state.calling=!0,DynamicSuite.call(this.package,this.form_api_create,t,t=>{switch(t.status){case"OK":this.state.show_created_confirmation=!0,this.form[this.form_storable_key]=parseInt(t.data),this.created=!0,this.state.calling=!1,this.setURIState(),this.readList(),setTimeout(()=>{this.state.show_created_confirmation=!1},1e3),this.$emit("create",t.data);break;case"INPUT_ERROR":this.state.show_failure_tick=!0;for(const e in t.data)this.error.form[e]=t.data[e];this.state.calling=!1;break;default:this.error.server=!0}})},runUpdate(){if(this.state.calling)return;this.resetFormFeedback();const t=Object.assign({},this.form,this.form_api_update_optional_data);this.state.calling=!0,DynamicSuite.call(this.package,this.form_api_update,t,t=>{switch(t.status){case"OK":this.state.show_success_tick=!0,this.state.calling=!1,this.$emit("update");break;case"INPUT_ERROR":this.state.show_failure_tick=!0;for(const e in t.data)this.error.form[e]=t.data[e];this.state.calling=!1;break;default:this.error.server=!0}})},runDelete(t=!1){if(this.resetFormFeedback(),t){const t=Object.assign({},this.form,this.form_api_delete_optional_data);this.state.calling=!0,DynamicSuite.call(this.package,this.form_api_delete,t,t=>{switch(t.status){case"OK":this.state.calling=!1,this.closeModals(),this.showForm(!1),this.clearURIState(),this.$emit("delete");break;case"DELETE_PROTECT":this.error.delete_protect=t.message,this.state.calling=!1,this.$emit("delete-protect");break;default:this.error.server=!0}})}else this.state.show_delete_modal=!0,this.$emit("delete-confirm")},closeModals(){this.state.calling||(this.state.show_delete_modal=!1),this.$emit("modals-closed")},setURIState(){const t=new Hashids.default,e=[this.state.show_form?1:0,this.tab_id?this.tab_id:0,this.form[this.form_storable_key]?this.form[this.form_storable_key]:0],i=new URLSearchParams(window.location.search),s=`_${this._uid}`,a=t.encode(e);this.state.show_form?i.set(s,a):i.delete(`_${this._uid}`);const r=i.toString().length?`?${i.toString()}`:window.location.href.split("?")[0];history.pushState(a,"",r)},clearURIState(){const t=new URLSearchParams(window.location.search);t.delete(`_${this._uid}`);const e=t.toString().length?`?${t.toString()}`:window.location.href.split("?")[0];history.replaceState(null,"",e)}},mounted(){this.list.limit=this.list_range_limit[0],this.$on("list-click",t=>{this.list_can_go_to_form&&this.readStorable(t)});const t=new URLSearchParams(window.location.search);if(t.has(`_${this._uid}`)){const e=(new Hashids.default).decode(t.get(`_${this._uid}`));3===e.length?(this.showForm(!!e[0]),this.tab_id=e[1],e[2]&&(this.tab=this.form_views[e[1]].name,this.tab_id=e[1],this.readStorable(e[2],!1),this.created=!0)):(this.clearURIState(),this.readList())}else this.readList();window.onpopstate=(t=>{if(t.state){const e=(new Hashids.default).decode(t.state);this.showForm(!!e[0]),this.tab=this.form_views[e[1]].name,this.tab_id=e[1]}else this.showForm(!1),this.clearURIState()})}});
Vue.component("aui-datalist",{template:'<div :id="id + \'-container\'" class="aui datalist"><label><span class="label-text" v-if="label">{{label}}</span><input :id="id" :class="input_classes" :name="name_computed" :type="type" :placeholder="placeholder" :disabled="disabled" :value="value" :list="id + \'-datalist\'" :autocomplete="autocomplete_computed" @keydown="$emit(\'keydown\')" @focus="$emit(\'focus\')" @blur="$emit(\'blur\')" @input="onInput"><datalist :id="id + \'-datalist\'"><option v-for="option in options" :value="option"></option></datalist></label><div v-if="subtext_value" class="subtext" :class="subtext_classes">{{subtext_value}}</div></div>',props:{id:{type:String,required:!0},label:{type:String},name:{type:String},type:{type:String,default:"text",validator:t=>-1!==["text","number"].indexOf(t)},placeholder:{type:String},disabled:{type:Boolean,default:!1},value:{type:String|Number|Boolean},options:{type:Array|Object,default:[]},success:{type:String|Boolean,default:!1},failure:{type:String|Boolean,default:!1},subtext:{type:String},disable_autofill:{type:Boolean,default:!0}},methods:{onInput(t){"object"==typeof this.options?Object.keys(this.options).forEach(e=>{this.options[e]===t.target.value&&t.target.blur()}):this.options.includes(t.target.value)&&t.target.blur(),this.$emit("input",t.target.value)}},computed:{input_classes(){return{"border-success":this.success,"border-failure":this.failure}},subtext_classes(){return{"text-success":this.success,"text-failure":this.failure}},subtext_value(){return"string"==typeof this.success?this.success:"string"==typeof this.failure?this.failure:this.subtext},autocomplete_computed(){return this.disable_autofill||"off"===this.autocomplete?"new-password":"on"},name_computed(){return this.disable_autofill?"autofill-disabled-"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15):this.name}},watch:{failure(){clearTimeout(window.aui_failure_timeout),window.aui_failure_timeout=setTimeout(()=>{let t=document.getElementById("ds-view"),e=document.querySelectorAll(".aui .border-failure")[0];if(e){let i=e.getBoundingClientRect(),s=i.top-i.height-100;t.scrollBy({top:s,behavior:"smooth"})}},99)}}});
Vue.component("aui-input",{template:'<div :id="container_id" class="aui input"><label><span class="label-text" v-if="label">{{label}}</span><span class="input-parent"><span v-if="leading_cap" class="leading-cap" :class="input_classes" v-html="leading_cap"></span><span v-if="trailing_cap" class="trailing-cap" :class="input_classes" v-html="trailing_cap"></span><input :id="id" :class="input_classes" :name="name_computed" :type="type" :placeholder="placeholder" :tabindex="tabindex" :disabled="disabled" :value="value" :step="step" :min="min" :max="max" :autocomplete="autocomplete_computed" ref="input" @keydown="$emit(\'keydown\', $event)" @change="$emit(\'change\', $event.target)" @select="$emit(\'select\', $event.target)" @focus="$emit(\'focus\', $event.target)" @blur="$emit(\'blur\', $event.target)" @input="$emit(\'input\', $event.target.value)" /></span></label><div v-if="subtext_value" class="subtext" :class="subtext_classes">{{subtext_value}}</div></div>',props:{id:{type:String},label:{type:String},leading_cap:{type:String},trailing_cap:{type:String},name:{type:String},type:{type:String,default:"text",validator:e=>-1!==["color","date","datetime-local","email","file","number","password","range","search","tel","text","time","url","week"].indexOf(e)},placeholder:{type:String},tabindex:{type:String|Number},disabled:{type:Boolean,default:!1},value:{type:String|Number|Boolean},step:{type:String|Number},min:{type:String|Number},max:{type:String|Number},autocomplete:{type:String,default:"on",validator:e=>-1!==["on","off"].indexOf(e)},success:{type:String|Boolean,default:!1},failure:{type:String|Boolean,default:!1},subtext:{type:String},no_feedback_icon:{type:Boolean,default:!1},disable_autofill:{type:Boolean,default:!0}},computed:{input_classes(){return{"border-success":this.success,"border-failure":this.failure,"no-feedback-icon":this.no_feedback_icon,"right-cap":this.trailing_cap,"left-cap":this.leading_cap}},subtext_classes(){return{"text-success":this.success,"text-failure":this.failure}},subtext_value(){return"string"==typeof this.success?this.success:"string"==typeof this.failure?this.failure:this.subtext},container_id(){return this.id?this.id+"-container":""},autocomplete_computed(){return this.disable_autofill||"off"===this.autocomplete?"new-password":"on"},name_computed(){return this.disable_autofill?"autofill-disabled-"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15):this.name}},watch:{failure(){clearTimeout(window.aui_failure_timeout),window.aui_failure_timeout=setTimeout(()=>{let e=document.getElementById("ds-view"),t=document.querySelectorAll(".aui .border-failure")[0];if(t){let a=t.getBoundingClientRect(),i=a.top-a.height-100;e.scrollBy({top:i,behavior:"smooth"})}},99)}},methods:{focus(){this.$refs.input.focus()},select(){this.$refs.input.select()}}});
Vue.component("aui-list-group",{template:'<ul class="aui list-group"><li v-for="(row, key) in rows" :key="key" @click="row.action"><span v-if="row.icon" class="leading-icon"><i :class="row.icon"></i></span><div class="text"><div class="title">{{row.title}}</div><div v-if="row.subtext" class="subtext">{{row.subtext}}</div></div><span class="trailing-icon"></span></li></ul>',props:{rows:{type:Array,required:!0,validator:i=>{for(const t of i){if("string"!=typeof t.title)return!1;if("function"!=typeof t.action)return!1}return!0}}}});
Vue.component("aui-modal",{template:'<div v-if="show" class="aui modal-container" @mousedown.self="runClose"><div class="modal"><div v-if="title" class="header" :class="modal_class"><h2>{{title}}</h2><i v-if="closeable" class="fas fa-times" @click.self="runClose"></i></div><div class="body"><slot></slot></div></div></div>',props:{type:{type:String,default:"primary",validator:e=>-1!==["none","primary","secondary","success","warning","failure"].indexOf(e)},show:{type:Boolean,required:!0},title:{type:String},closeable:{type:Boolean,default:!0}},computed:{modal_class(){return"none"===this.type?"":"modal-"+this.type}},methods:{escapeClose(e){"Escape"===e.key&&this.runClose()},runClose(){if(!this.closeable)return!1;this.$emit("close")}},watch:{show(){this.show&&document.getElementById("ds-nav-container")&&document.getElementById("ds-view-header")?(document.getElementById("ds-nav-container").style.zIndex="0",document.getElementById("ds-view-header").style.zIndex="-1",document.getElementById("ds-nav-container").classList.remove("ds-nav-show-mobile"),document.getElementById("ds-view").style.overflowY="hidden"):!this.show&&document.getElementById("ds-nav-container")&&document.getElementById("ds-view-header")&&(document.getElementById("ds-nav-container").style.zIndex="1",document.getElementById("ds-view-header").style.zIndex="0",document.getElementById("ds-view").style.overflowY="auto")}},created(){this.closeable&&document.addEventListener("keyup",this.escapeClose)},beforeDestroy(){this.closeable&&document.removeEventListener("keyup",this.escapeClose)}});
Vue.component("aui-notice",{template:'<div class="aui notice"><i :class="icon_classes"></i><h4><slot>{{text}}</slot></h4><span v-if="subtext" v-html="subtext"></span></div>',props:{type:{type:String,default:"secondary",validator:t=>-1!==["primary","secondary","success","warning","failure"].indexOf(t)},icon:{type:String,default:"fas fa-cog"},text:{type:null|String,default:null},subtext:{type:null|String,default:null}},computed:{icon_classes(){let t={};return t[this.icon]=!0,t[this.type]=!0,t}}});
Vue.component("aui-number",{template:'<span class="aui number" :class="negative_class">{{pretty_value}}</span>',props:{is_currency:{type:Boolean,default:!1},currency_symbol:{type:String,default:"$"},padding:{type:null|Number,default:null,validator:e=>e>=0&&parseInt(e)===e},number:{type:Number|String,required:!0}},computed:{negative_class(){return{negative:parseFloat(this.number.toString().replace(/[^0-9.-]/g,""))<0}},pretty_value(){const e=this.number.toString().replace(/[^0-9.-]/g,""),t=this.is_currency?this.currency_symbol:"",r=parseFloat(e)<0,n=Math.abs(parseInt(e.split(".")[0])).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),a=e.split(".")[1],s=null!==this.padding?this.padding:this.is_currency?2:0;let l=".";return a?l+=a.toString().length<s?a.padEnd(s,"0"):a:l=s>0?l.padEnd(s+1,"0"):"",(r?"-":"")+(t||"")+`${n}${l}`}}});
Vue.component("aui-phone",{template:'<span class="aui phone">{{formatted_phone}}</span>',props:{number:{type:null|String,default:null}},computed:{formatted_phone(){const t=this.number.replace(/[^0-9]/g,""),e=t.length;return 10===e?`(${t.substr(0,3)}) ${t.substr(3,3)}-${t.substr(6,4)}`:11===e&&"1"===t.charAt(0)?`+1 (${t.substr(1,3)}) ${t.substr(4,3)}-${t.substr(7,4)}`:this.number}}});
Vue.component("aui-radio",{template:'<label class="aui radio"><slot></slot><input type="radio" :name="group" :value="data" @change="$emit(\'input\', $event.target.value)"><span class="bubble"></span></label>',props:{group:{type:String,required:!0},data:{type:String|Number|Boolean}}});
Vue.component("aui-select",{template:'<div :id="container_id" class="aui select"><label><span class="label-text" v-if="label">{{label}}</span><select :id="id" :class="input_classes" :name="name_computed" :disabled="disabled" :value="value" :autocomplete="autocomplete_computed" @input="$emit(\'input\', $event.target.value)" @change="$emit(\'change\', $event.target.value)"><option v-for="(option, value) in render_options" :value="value">{{option}}</option></select></label><div v-if="subtext_value" class="subtext" :class="subtext_classes">{{subtext_value}}</div></div>',props:{id:{type:String},label:{type:String},name:{type:String},disabled:{type:Boolean,default:!1},value:{type:String|Number|Boolean},options:{type:Array|Object},success:{type:String|Boolean,default:!1},failure:{type:String|Boolean,default:!1},subtext:{type:String},us_states:{type:Boolean,default:!1},no_feedback_icon:{type:Boolean,default:!1},disable_autofill:{type:Boolean,default:!0}},data:()=>({states:{0:"",AL:"Alabama",AK:"Alaska",AS:"American Samoa",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FM:"Federated States Of Micronesia",FL:"Florida",GA:"Georgia",GU:"Guam",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MH:"Marshall Islands",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",MP:"Northern Mariana Islands",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PW:"Palau",PA:"Pennsylvania",PR:"Puerto Rico",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VI:"Virgin Islands",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"}}),computed:{render_options(){return this.us_states?this.states:this.options},input_classes(){return{"border-success":this.success,"border-failure":this.failure,"no-feedback-icon":this.no_feedback_icon}},subtext_classes(){return{"text-success":this.success,"text-failure":this.failure}},subtext_value(){return"string"==typeof this.success?this.success:"string"==typeof this.failure?this.failure:this.subtext},container_id(){return this.id?this.id+"-container":""},autocomplete_computed(){return this.disable_autofill||"off"===this.autocomplete?"new-password":"on"},name_computed(){return this.disable_autofill?"autofill-disabled-"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15):this.name}},watch:{failure(){clearTimeout(window.aui_failure_timeout),window.aui_failure_timeout=setTimeout(()=>{let e=document.getElementById("ds-view"),t=document.querySelectorAll(".aui .border-failure")[0];if(t){let a=t.getBoundingClientRect(),i=a.top-a.height-100;e.scrollBy({top:i,behavior:"smooth"})}},99)}}});
Vue.component("aui-table",{template:'<div class="aui table"><table><thead v-if="show_headers"><tr><th v-for="header in columns">{{header}}</th></tr></thead><tbody><tr v-for="row in rows"><td v-if="columns[column]" v-for="(value, column) in row">{{value}}</td></tr><tr v-if="no_data"><td class="no-data" :colspan="column_count">No rows in dataset</td></tr></tbody></table></div>',props:{columns:{type:Object,required:!0},show_headers:{type:Boolean,default:!0},rows:{type:Array,required:!0}},computed:{no_data(){return 0===this.rows.length},column_count(){return Object.keys(this.columns).length}}});
Vue.component("aui-tabs",{template:'<div class="aui tabs"><span v-if="!collapsed" v-for="tab in tab_structure" class="tab" :class="tabClass(tab.id)" @click="tab.action">{{tab.label}}</span><aui-button-drop v-if="collapsed" :dropdown="tab_structure">{{tab_name}}</aui-button-drop></div>',props:{tabs:{type:Object,required:!0},initial_tab:{type:String|Number,default:null}},data:()=>({width:0,collapsed:!1,tab:null}),computed:{tab_structure(){let t=[],i=Object.keys(this.tabs);for(let e=0;e<i.length;e++){let s=i[e];t[e]={id:s,label:this.tabs[s],action:()=>{this.tab=s,this.$emit("change",this.tab)}}}return t},tab_name(){return this.tabs[this.tab]}},methods:{checkIfCollapsed(){window.requestAnimationFrame(()=>{this.collapsed=this.$el.clientWidth<=this.width||this.$el.clientWidth+40>=window.innerWidth})},tabClass(t){return{active:null!==this.tab&&this.tab.toString()===t.toString()}}},created(){window.addEventListener("resize",this.checkIfCollapsed)},mounted(){for(let t=0;t<this.$el.childNodes.length;t++)"number"==typeof this.$el.childNodes[t].offsetWidth&&(this.width+=this.$el.childNodes[t].offsetWidth+1);this.width=this.width+32,this.checkIfCollapsed(),null!==this.initial_tab?this.tab=this.initial_tab:this.tab=Object.keys(this.tabs)[0]},watch:{initial_tab(t){this.tab=t}},beforeDestroy(){window.removeEventListener("resize",this.checkIfCollapsed)}});
Vue.component("aui-telephone",{template:'<div class="aui telephone"><aui-input class="country" v-if="show_country" v-model="country_code" @change="maskCode(country_code)"></aui-input><aui-input class="phone-number" label="Phone Number" type="tel" v-model="number" @input="maskNumber(number)"></aui-input></div>',props:{show_country:{type:Boolean,default:!1}},data:()=>({country_code:"+1",number:null}),methods:{maskCode(e){e=`+${e.match(/\d+/)[0]}`},maskNumber(e){(e=e.toString().replace("(","").replace(")","").replace("-","").replace(" ","")).length<3?this.number=e:e.length<6?this.number=e.toString().replace(/(\d{3})/,"($1) "):this.number=e.toString().replace(/(\d{3})(\d{1,3})/,"($1) $2-")},emit:(e,t)=>t.replace(/\D/g,"").substring(0,8),inputHandler(){}}});
Vue.component("aui-textarea",{template:'<div :id="container_id" class="aui textarea"><label><span class="label-text" v-if="label">{{label}}</span><textarea :id="id" :class="input_classes" :name="name_computed" :placeholder="placeholder" :disabled="disabled" :value="value" ref="textarea" @keydown="$emit(\'keydown\', $event)" @change="$emit(\'change\', $event.target)" @select="$emit(\'select\', $event.target)" @focus="$emit(\'focus\', $event.target)" @blur="$emit(\'blur\', $event.target)" @input="$emit(\'input\', $event.target.value)" /></label><div v-if="subtext_value" class="subtext" :class="subtext_classes">{{subtext_value}}</div></div>',props:{id:{type:String},label:{type:String},name:{type:String},placeholder:{type:String},disabled:{type:Boolean,default:!1},value:{type:String|Number|Boolean},success:{type:String|Boolean,default:!1},failure:{type:String|Boolean,default:!1},subtext:{type:String},no_feedback_icon:{type:Boolean,default:!1}},computed:{input_classes(){return{"border-success":this.success,"border-failure":this.failure,"no-feedback-icon":this.no_feedback_icon,"right-cap":this.trailing_cap,"left-cap":this.leading_cap}},subtext_classes(){return{"text-success":this.success,"text-failure":this.failure}},subtext_value(){return"string"==typeof this.success?this.success:"string"==typeof this.failure?this.failure:this.subtext},container_id(){return this.id?this.id+"-container":""},name_computed(){return this.disable_autofill?"autofill-disabled-"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15):this.name}},watch:{failure(){clearTimeout(window.aui_failure_timeout),window.aui_failure_timeout=setTimeout(()=>{let e=document.getElementById("ds-view"),t=document.querySelectorAll(".aui .border-failure")[0];if(t){let i=t.getBoundingClientRect(),a=i.top-i.height-100;e.scrollBy({top:a,behavior:"smooth"})}},99)}},methods:{focus(){this.$refs.input.focus()},select(){this.$refs.input.select()}}});
Vue.component("aui-toggle",{template:'<label class="aui toggle"><span class="label-text">{{label}}</span><span class="switch"><input type="checkbox" :checked="toggled" :disabled="disabled" @change="$emit(\'input\', $event.target.checked)"><span class="slider"></span></span></label>',props:{toggled:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},label:{type:null|String,default:null}}});
Vue.component("aui-wysiwyg",{template:'<div :id="id + \'-container\'" class="aui wysiwyg"><label>{{label}}</label><div :id="id"></div></div>',props:{id:{type:String,required:!0},label:{type:String},text:{type:String,default:""}},data:()=>({editor:null}),mounted(){this.editor=pell.init({element:document.getElementById(this.id),defaultParagraphSeparator:"p",styleWithCSS:!0,onChange:t=>{this.$emit("input",t)},actions:["bold","italic","underline","heading1","ulist","olist"],classes:{actionbar:"pell-actionbar",button:"pell-btn",content:"pell-content",selected:"pell-button-selected"}}),this.editor.content.innerHTML=this.text},watch:{text(){""===this.editor.content.innerHTML&&(this.editor.content.innerHTML=this.text)}}});
