/*
  Dynamic Suite: AUI
  License: GPLv3
*/
Vue.component("aui-alert",{template:'<div v-if="show" class="aui alert" :class="style_class"><div><h3 v-if="title">{{title}}</h3><slot>{{text}}</slot></div><i v-if="closeable" class="fa fa-times close" @click="handleClose"></i></div>',props:{type:{type:String,default:"primary",validator:e=>-1!==["none","primary","secondary","success","warning","failure"].indexOf(e)},title:{type:String},text:{type:null|String,required:!1},show:{type:Boolean|String|null,default:!0},closeable:{type:Boolean,default:!1}},computed:{style_class(){return{[`alert-${this.type}`]:"none"!==this.type}}},methods:{handleClose(){this.$emit("update:show",!1),this.$emit("close")}}});
Vue.component("aui-badge",{template:'<span class="aui badge" :class="style_class"><slot>{{text}}</slot></span>',props:{type:{type:String,default:"primary",validator:e=>-1!==["none","primary","secondary","success","warning","failure"].indexOf(e)},text:{type:String|Number,required:!0}},computed:{style_class(){return{[`badge-${this.type}`]:"none"!==this.type}}}});
Vue.component("aui-button",{template:'<button class="aui btn" :class="style_class" :disabled="is_disabled" @click="$emit(\'click\')"><span v-if="loading"><i class="fa fa-spin fa-circle-notch"></i><span v-if="loading_text" class="loading-text">{{loading_text}}</span><slot v-else>{{text}}</slot></span><slot v-else>{{text}}</slot><aui-badge v-if="badge" :type="badge" :text="badge_text"/></button>',props:{type:{type:String,default:"primary",validator:t=>-1!==["none","primary","secondary","success","warning","failure"].indexOf(t)},text:{type:null|String,default:null},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loading_text:{type:String,default:null},badge:{type:String,default:null,validator:t=>-1!==[null,"none","primary","secondary","success","warning","failure"].indexOf(t)},badge_text:{type:String,default:"!"}},computed:{style_class(){return{[`btn-${this.type}`]:"none"!==this.type}},is_disabled(){return this.loading||this.disabled}}});
Vue.component("aui-button-drop",{template:'<div class="aui btn-drop" ref="dropdown"><button class="aui btn" :class="style_class" :disabled="is_disabled" @click="toggle"><span v-if="text || $slots.default"><slot>{{text}}</slot></span><i :class="icon_class"></i></button><ul v-show="show_dropdown" class="dropdown" ref="menu" :class="list_classes"><li v-for="(text, event) in dropdown" :key="\'entry-\' + event" @click="handleClick(event)">{{text}}</li></ul></div>',props:{type:{type:String,default:"primary",validator:t=>-1!==["none","primary","secondary","success","warning","failure"].indexOf(t)},text:{type:null|String,default:null},dropdown:{type:Object,required:!0,validator(t){for(const e in t)if("string"!=typeof t[e])return!1;return!0}},disabled:{type:Boolean,default:!1},icon_inactive:{type:String,default:"fas fa-caret-down"},icon_active:{type:String,default:"fas fa-caret-up"},menu_align:{type:String,default:"left",validator:t=>-1!==["left","right"].indexOf(t)},relative_to:{type:null|String,default:null}},computed:{style_class(){return{[`btn-${this.type}`]:"none"!==this.type}},is_disabled(){return this.loading||this.disabled},icon_class(){return this.show_dropdown?this.icon_active:this.icon_inactive},list_classes(){return{top:!!this.anchor_top,[this.menu_align_master]:!!this.menu_align_master,[this.menu_align]:!this.menu_align_master}}},data:()=>({show_dropdown:!1,anchor_top:!1,menu_align_master:null}),methods:{handleClick(t){this.$emit(t),this.$emit("menu-click",t),this.show_dropdown=!1},toggle(){this.show_dropdown=!this.show_dropdown,this.menu_align_master=null,this.anchor_top=!1,this.$nextTick(()=>{this.$refs.menu.style.opacity="0";const t=this.$refs.menu.getBoundingClientRect();let e=window.innerHeight-t.bottom,i=window.innerWidth-t.right;if(this.relative_to){const n=this.$refs.menu.closest(this.relative_to);n&&(e=n.offsetHeight-t.bottom,i=n.offsetWidth-t.right)}i<0&&(this.menu_align_master="right"),e<0&&(this.anchor_top=!0),this.$refs.menu.style.opacity="1"})},blurDropdownMenu(t){this.$refs.dropdown.contains(t.target)||(this.show_dropdown=!1)}},created(){window.addEventListener("click",this.blurDropdownMenu)},beforeDestroy(){window.removeEventListener("click",this.blurDropdownMenu)}});
Vue.component("aui-checkbox",{template:'<aui-form-control v-bind="properties"><input type="checkbox" :value="value" :checked="checked" :disabled="disabled" @input="$emit(\'input\', $event.target.checked)" /></aui-form-control>',props:{label:{type:null|String,default:null},value:{type:String|Number|Boolean|null,default:null},checked:{type:Boolean|Number,default:!1},disabled:{type:Boolean,default:!1},success:{type:null|String,default:null},failure:{type:null|String,default:null},subtext:{type:null|String,default:null}},computed:{properties(){return{parent:"checkbox",label:this.$slots.default?this.$slots.default:this.label,success:this.success,failure:this.failure,subtext:this.subtext}}}});
Vue.component("aui-crud",{template:'<div class="aui crud aui-container primary"><aui-notice v-if="show_error" type="failure" icon="fas fa-exclamation-triangle" text="A server error has occurred" subtext="Please reload the page" /><aui-notice v-if="show_created_confirmation" type="success" icon="fas fa-check-circle" :text="form_created_confirmation_text" /><div v-if="show_list" class="list"><div class="header"><div class="title"><h2><slot name="list-title">CRUD List</slot></h2></div><div class="action"><slot name="list-buttons" :readList="readList" /><aui-button v-if="list_show_create_button" :disabled="state.overlay" @click="setupCreate"><i class="fas fa-plus"></i></aui-button><aui-input v-if="list_show_search" placeholder="Search" :disabled="state.overlay" v-model="list.search" @input="runSearch" /></div></div><div class="data"><aui-notice v-if="!has_list_data && !calling" :icon="list_empty_icon" :text="list_empty_text" :subtext="list_empty_subtext" /><div v-if="state.overlay" :class="list_overlay_classes"><aui-notice :icon="list_overlay_icon" :text="list_overlay_text" :subtext="list_overlay_subtext" /></div><aui-list-group v-if="list_is_group" :list="list_group_data" @click="emitListClick" /><table v-if="list_is_table" :class="list_table_classes"><thead><tr><th v-for="(column, key) in list_table_columns" :key="\'header-\' + key" :class="listTableColumnClasses(key)" @click="sortList(key)">{{listTableColumnName(column)}}<i v-if="isSortedAsc(key)" class="fas fa-sort-amount-down-alt"></i><i v-else-if="isSortedDesc(key)" class="fas fa-sort-amount-down"></i><i v-else class="fas fa-sort"></i></th></tr></thead><tbody><tr v-for="(row, key) in list_table_data" :key="\'row-\' + key" @click="emitListClick(row.id)"><td v-for="(value, column) in row.data" :key="\'column-\' + column" :class="listTableColumnClasses(column)" v-html="listTableColumnFormat(column, value)" /></tr></tbody></table></div><aui-pagination v-if="has_list_data" :disabled="state.overlay" :page.sync="list.page" :total="list.total" :limit.sync="list.limit" :list_range_limit="list_range_limit" @paginate="readList" /></div><div v-if="show_form" class="form"><aui-tabs v-if="view_show_tabs" :tabs="view_tabs" :tab.sync="tab" @change="handleTabChange" /><div class="body" v-for="(form, key) in form_views" :key="\'view-\' + key"><slot v-if="isActiveTab(key)" :form="form" :name="key" :overlay="state.overlay" :showForm="showForm" :runCreate="runCreate" :runUpdate="runUpdate" :runDelete="runDelete" :closeModals="closeModals" /></div><div v-if="view_show_action_bar" class="action"><aui-button type="secondary" :disabled="state.overlay" text="Back" @click="showForm(false)" /><div class="primary"><i v-if="state.show_failure_tick" class="tic fas fa-times" /><i v-if="state.show_success_tick" class="tic fas fa-check" /><aui-button v-if="!is_valid" :loading="state.overlay" loading_text="Creating..." text="Create" @click="runCreate" /><div v-else class="btn-group"><aui-button :loading="form_update_is_running" loading_text="Updating..." text="Update" @click="runUpdate" /><aui-button-drop :dropdown="form_delete_dropdown" :disabled="state.overlay" @delete="runDelete" /></div></div></div><aui-modal type="failure" title="Confirm Delete" :show.sync="state.show_delete_modal"><template #content><p>{{form_delete_text}}</p><aui-input label="Type DELETE to confirm" v-model="delete_confirm" /><aui-alert v-if="error.delete_protect" type="failure" :text="error.delete_protect" /></template><template #left><aui-button type="secondary" :disabled="state.overlay" text="Cancel" @click="closeModals" /></template><template #right><aui-button type="failure" :disabled="form_delete_disabled" :loading="state.overlay" loading_text="Deleting..." text="Delete" @click="runDelete(true)" /></template></aui-modal></div></div>',props:{package:{type:String,required:!0},list_type:{type:String,default:"group",validator:t=>-1!==["group","table"].indexOf(t)},list_can_go_to_form:{type:Boolean,default:!0},list_interactive:{type:Boolean,default:!0},list_table_columns:{type:Object,default:()=>{},validator:t=>{for(const e in t)if("object"==typeof t[e]){if("string"!=typeof t[e].label)return!1;if(void 0!==t[e].format&&"function"!=typeof t[e].format)return!1}return!0}},list_empty_icon:{type:String,default:"fas fa-ban"},list_empty_text:{type:null|String,default:"No data found"},list_empty_subtext:{type:null|String,default:null},list_overlay_icon:{type:String,default:"fas fa-circle-notch fa-spin"},list_overlay_text:{type:null|String,default:null},list_overlay_subtext:{type:null|String,default:null},list_show_create_button:{type:Boolean,default:!0},list_show_search:{type:Boolean,default:!0},list_range_limit:{type:Array,default:()=>[15,25,50,100]},list_api_read:{type:String,required:!0},list_api_read_optional_data:{type:Object,default:()=>{}},form:{type:Object,default:()=>{}},feedback:{type:Object,default:()=>{}},calling:{type:Boolean,required:!0},form_api_read:{type:String},form_api_read_optional_data:{type:Object,default:()=>{}},form_api_create_setup:{type:String},form_api_create_setup_optional_data:{type:Object,default:()=>{}},form_api_create:{type:String},form_api_create_optional_data:{type:Object,default:()=>{}},form_api_update:{type:String},form_api_update_optional_data:{type:Object,default:()=>{}},form_api_delete:{type:String},form_api_delete_optional_data:{type:Object,default:()=>{}},form_created_confirmation_text:{type:String,default:"Created"},form_storable_key:{type:String,default:"id"},form_delete_text:{type:String,default:"Are you sure you want to delete?"},fields:{type:Array,default:()=>[],validator:t=>{for(const e of t)if("string"!=typeof e)return!1;return!0}},secure_fields:{type:Array,default:()=>[],validator:t=>{for(const e of t)if("string"!=typeof e)return!1;return!0}},views:{type:Object,default:()=>{},validator:t=>{for(const e in t){if("object"!=typeof t[e]&&"string"!=typeof t[e])return!1;if("object"==typeof t[e]){if("string"!=typeof t[e].name)return!1;if(void 0!==t[e].show_action_bar&&"boolean"!=typeof t[e].show_action_bar)return!1}}return!0}}},data:()=>({list:{data:[],limit:0,total:0,page:1,search_timer:null,search:null,sort:{},sort_order:[]},tab:null,form_delete_dropdown:{delete:"Delete"},delete_confirm:null,state:{overlay:!1,show_form:!1,show_delete_modal:!1,show_failure_tick:!1,show_success_tick:!1,show_created_confirmation:!1},error:{server:!1,delete_protect:null},page_state:{show_create:0,show_storable:0,tab_index:0}}),computed:{show_error(){return this.error.server},show_list(){return!this.error.server&&!this.state.show_form&&!this.state.show_created_confirmation},show_form(){return!this.error.server&&this.state.show_form&&!this.state.show_created_confirmation},show_created_confirmation(){return!this.error.server&&this.state.show_created_confirmation},has_list_data(){return this.list.data.length>0},list_is_group(){return this.has_list_data&&"group"===this.list_type},list_is_table(){return this.has_list_data&&"table"===this.list_type},list_group_data(){const t=[];if("group"!==this.list_type)return t;for(const e of this.list.data)t.push({icon:e.icon?e.icon:"",title:e.title,subtext:e.subtext,value:e[this.form_storable_key]});return t},list_table_data(){const t=[];if("table"!==this.list_type)return t;for(const e of this.list.data){const s={id:e[this.form_storable_key],data:{}};for(const t in this.list_table_columns)void 0!==e[t]&&(s.data[t]=e[t]);t.push(s)}return t},list_overlay_classes(){return{overlay:!0,empty:this.list.data.length<=0}},list_table_classes(){return{interactive:this.list_interactive||this.list_can_go_to_form}},form_update_is_running(){return this.state.overlay&&!this.state.show_delete_modal},form_views(){const t={};for(const e in this.views)t[e]={name:"string"==typeof this.views[e]?this.views[e]:this.views[e].name,show_action_bar:"boolean"!=typeof this.views[e].show_action_bar||this.views[e].show_action_bar};return t},form_delete_disabled(){return"DELETE"!==this.delete_confirm},view_show_tabs(){return Object.keys(this.views).length>1&&this.is_valid},view_tabs(){const t={};for(const e in this.form_views)t[e]=this.form_views[e].name;return t},view_show_action_bar(){return this.form_views[this.tab].show_action_bar},is_valid(){return!!this.form[this.form_storable_key]}},watch:{calling:function(t){t?setTimeout(()=>{this.calling&&(this.state.overlay=!0)},100):this.state.overlay=!1}},methods:{readList(){if(this.calling)return;const t=Object.assign({type:this.list_type,page:this.list.page,limit:this.list.limit,search:this.list.search,sort:this.list.sort,sort_order:this.list.sort_order},this.list_api_read_optional_data);this.$emit("update:calling",!0),DynamicSuite.call(this.package,this.list_api_read,t,t=>{switch(t.status){case"OK":this.list.data=t.data.list,this.list.total=t.data.total,this.$emit("update:calling",!1);break;default:this.error.server=!0}})},runSearch(){clearTimeout(this.list.search_timer),this.list.search_timer=setTimeout(()=>{this.list.page=1,this.readList()},300)},listTableColumnName:t=>"object"==typeof t?t.label:t,listTableColumnFormat(t,e){return"string"==typeof this.list_table_columns[t]?e:this.list_table_columns[t].format(e)},listTableColumnClasses(t){return{hide_on_ipad:"object"==typeof this.list_table_columns[t]&&!0===this.list_table_columns[t].hide_on_ipad,hide_on_mobile:"object"==typeof this.list_table_columns[t]&&!0===this.list_table_columns[t].hide_on_mobile}},sortList(t){void 0===this.list.sort[t]?(this.list.sort_order.push(t),this.$set(this.list.sort,t,"ASC")):"ASC"===this.list.sort[t]?this.$set(this.list.sort,t,"DESC"):(this.list.sort_order.splice(this.list.sort_order.indexOf(t),1),this.$delete(this.list.sort,t)),this.list.page=1,this.readList()},isSortedAsc(t){return void 0!==this.list.sort[t]&&"ASC"===this.list.sort[t]},isSortedDesc(t){return void 0!==this.list.sort[t]&&"DESC"===this.list.sort[t]},emitListClick(t){this.$emit("list-click",t)},secureFields(){const t=this.form;for(const e of this.secure_fields)t[e]=null;this.$emit("update:form",t)},showForm(t,e=0){this.tab=Object.keys(this.views)[e],t?(this.page_state.show_create=this.is_valid?0:1,this.page_state.show_storable=this.is_valid?this.form[this.form_storable_key]:0,this.page_state.tab_index=Object.keys(this.views).indexOf(this.tab)):(this.page_state.show_create=0,this.page_state.show_storable=0,this.page_state.tab_index=0,this.readList()),this.$emit("page-state-change"),this.state.show_form=t},resetForm(){const t=this.form;for(const e in t)t[e]=null;this.$emit("update:form",t)},setForm(t){this.resetFormFeedback(),this.$emit("update:form",Object.assign(this.form,t))},setupCreate(){if(this.resetForm(),this.resetFormFeedback(),this.form_api_create_setup){const t=Object.assign({},this.form_api_create_setup_optional_data);this.$emit("update:calling",!0),DynamicSuite.call(this.package,this.form_api_create_setup,t,t=>{switch(t.status){case"OK":this.setForm(t.data),this.$emit("update:calling",!1),this.showForm(!0);break;default:this.clearURIState(),this.error.server=!0}})}else this.showForm(!0)},isActiveTab(t){return t===this.tab},readStorable(t,e=0){if(this.calling)return;const s=Object.assign({[this.form_storable_key]:t},this.form_api_read_optional_data);this.$emit("update:calling",!0),DynamicSuite.call(this.package,this.form_api_read,s,t=>{switch(t.status){case"OK":this.setForm(t.data),this.showForm(!0,e),this.$emit("update:calling",!1);break;case"NOT_FOUND":this.showForm(!1),this.$emit("update:calling",!1);break;default:this.error.server=!0}})},setFeedback(t){const e=Object.assign({},this.feedback);for(const s in t)e[s]=t[s];this.$emit("update:feedback",e)},resetFormFeedback(){this.state.show_failure_tick=!1,this.state.show_success_tick=!1,this.error.delete_protect=null;const t=Object.assign({},this.feedback);for(const e in this.feedback)t[e]=null;this.$emit("update:feedback",t)},runCreate(){if(this.calling)return;this.resetFormFeedback();const t=Object.assign({},this.form,this.form_api_create_optional_data);this.$emit("update:calling",!0),DynamicSuite.call(this.package,this.form_api_create,t,t=>{switch(t.status){case"OK":this.state.show_created_confirmation=!0,this.setForm({[this.form_storable_key]:parseInt(t.data)}),this.$emit("update:calling",!1),this.secureFields(),this.readList(),setTimeout(()=>{this.state.show_created_confirmation=!1},1e3);break;case"INPUT_ERROR":this.state.show_failure_tick=!0,this.setFeedback(t.data),this.$emit("update:calling",!1);break;default:this.error.server=!0}})},runUpdate(){if(this.calling)return;this.resetFormFeedback();const t=Object.assign({},this.form,this.form_api_update_optional_data);this.$emit("update:calling",!0),DynamicSuite.call(this.package,this.form_api_update,t,t=>{switch(t.status){case"OK":this.state.show_success_tick=!0,this.$emit("update:calling",!1),this.secureFields();break;case"INPUT_ERROR":this.state.show_failure_tick=!0,this.setFeedback(t.data),this.$emit("update:calling",!1);break;default:this.error.server=!0}})},runDelete(t=!1){if(this.resetFormFeedback(),t){const t=Object.assign({},this.form,this.form_api_delete_optional_data);this.$emit("update:calling",!0),DynamicSuite.call(this.package,this.form_api_delete,t,t=>{switch(t.status){case"OK":this.$emit("update:calling",!1),this.$nextTick(()=>{this.closeModals(),this.showForm(!1),this.secureFields()});break;case"DELETE_PROTECT":this.error.delete_protect=t.message,this.$emit("update:calling",!1);break;default:this.error.server=!0}})}else this.delete_confirm=null,this.state.show_delete_modal=!0},closeModals(){this.calling||(this.state.show_delete_modal=!1)},handleTabChange(t){this.page_state.tab_index=Object.keys(this.views).indexOf(t),this.$emit("page-state-change")}},mounted(){this.tab=Object.keys(this.views)[0],this.list.limit=this.list_range_limit[0],this.$on("list-click",t=>{this.list_can_go_to_form&&this.readStorable(t)});const t=()=>{this.page_state.show_create?this.setupCreate():this.page_state.show_storable?this.readStorable(this.page_state.show_storable,this.page_state.tab_index):this.showForm(!1)},e=new URLSearchParams(window.location.search),s=`_${this._uid}`;if(e.get(s)){const i=(new Hashids.default).decode(e.get(s));this.page_state.show_create=i[0],this.page_state.show_storable=i[1],this.page_state.tab_index=i[2],t()}else this.readList();this.$on("page-state-change",()=>{const t=new Hashids.default,e=new URLSearchParams(window.location.search),s=`_${this._uid}`,i=Object.values(this.page_state),a=t.encode(i),r=(t,e)=>{const s=t.toString().length?`?${t.toString()}`:window.location.href.split("?")[0];history.pushState(e,"",s)};i.reduce((t,e)=>t+e)&&e.get(s)!==a?(e.set(s,a),r(e,a)):!i.reduce((t,e)=>t+e)&&e.has(s)&&(e.delete(s),r(e,null))}),window.onpopstate=(e=>{if(e.state){const s=(new Hashids.default).decode(e.state);this.page_state.show_create=s[0],this.page_state.show_storable=s[1],this.page_state.tab_index=s[2],t()}else this.showForm(!1)})}});
Vue.component("aui-form-control",{template:'<div class="aui form-control" :class="container_classes"><label v-if="can_have_caps" class="standard-container"><span v-if="label" class="label" v-html="label"/><span class="cap-container"><span v-if="leading_cap" class="leading-cap" v-html="leading_cap" /><span v-if="trailing_cap" class="trailing-cap" v-html="trailing_cap" /><slot /></span></label><label v-if="has_pseudo" class="pseudo-container"><slot /><span v-if="has_pseudo" class="pseudo" /><span v-if="label" class="label" v-html="label" /></label><label v-if="is_wysiwyg && label" class="label" v-html="label" /><slot v-if="is_wysiwyg" /><span v-if="subtext_value" class="subtext">{{subtext_value}}</span></div>',props:{parent:{type:String,required:!0,validator:e=>-1!==["checkbox","input","radio","select","textarea","toggle","wysiwyg"].indexOf(e)},label:{type:null|String,required:!1,default:null},leading_cap:{type:null|String,default:null},trailing_cap:{type:null|String,default:null},success:{type:null|String,default:null},failure:{type:null|String,default:null},subtext:{type:null|String,default:null},no_feedback_icon:{type:Boolean,default:!1}},computed:{has_pseudo(){return"checkbox"===this.parent||"radio"===this.parent||"toggle"===this.parent},can_have_caps(){return"input"===this.parent||"select"===this.parent||"textarea"===this.parent},is_wysiwyg(){return"wysiwyg"===this.parent},container_classes(){return{[this.parent]:!0,success:!!this.success,failure:!!this.failure,"no-feedback-icon":this.no_feedback_icon}},subtext_value(){return"string"==typeof this.success?this.success:"string"==typeof this.failure?this.failure:this.subtext}},watch:{failure(){clearTimeout(window.aui_form_control_failure_timeout),window.aui_form_control_failure_timeout=setTimeout(()=>{let e=document.getElementById("ds-view");e||(e=document.body);const t=document.querySelectorAll(".aui.form-control.failure")[0];if(t){const l=t.getBoundingClientRect();e.scrollBy({top:l.top-l.height-100,behavior:"smooth"})}},99)}}});
Vue.component("aui-input",{template:'<aui-form-control v-bind="properties"><input ref="input" :value="value" :type="type" :list="unique_id" :autocomplete="autocomplete" :placeholder="placeholder" :tabindex="tabindex" :disabled="disabled" :step="step" :min="min" :max="max" @focus="$emit(\'focus\', $event.target)" @blur="$emit(\'blur\', $event.target)" @input="handleInput($event.target.value)" @keydown="$emit(\'keydown\', $event)" /><datalist v-if="!!options.length" :id="unique_id"><option v-for="(value, key) in options" :key="\'option-\' + key" :value="value" /></datalist></aui-form-control>',props:{label:{type:null|String,default:null},leading_cap:{type:null|String,default:null},trailing_cap:{type:null|String,default:null},value:{type:String|Number|Boolean|null,default:null},type:{type:String,default:"text",validator:e=>-1!==["color","date","datetime-local","email","file","number","password","range","search","tel","text","time","url","week"].indexOf(e)},autocomplete:{type:null|String,default:null},placeholder:{type:null|String,default:null},disabled:{type:Boolean,default:!1},options:{type:Array,default:()=>[]},tabindex:{type:String|Number|null,default:null},step:{type:String|Number|null,default:null},min:{type:String|Number|null,default:null},max:{type:String|Number|null,default:null},success:{type:null|String,default:null},failure:{type:null|String,default:null},subtext:{type:null|String,default:null},no_feedback_icon:{type:Boolean,default:!1}},computed:{properties(){return{parent:"input",label:this.$slots.default?this.$slots.default:this.label,leading_cap:this.leading_cap,trailing_cap:this.trailing_cap,success:this.success,failure:this.failure,subtext:this.subtext,no_feedback_icon:this.no_feedback_icon}},unique_id(){return`aui-input-${this._uid}`}},methods:{handleInput(e){if("tel"===this.type){let t=e.replace(/\D/g,"").match(/(\d{0,3})(\d{0,3})(\d{0,4})/);e=t[2]?"("+t[1]+") "+t[2]+(t[3]?"-"+t[3]:""):t[1],this.$refs.input.value=e}this.$emit("input",e)}}});
Vue.component("aui-list-group",{template:'<ul class="aui list-group"><li v-for="(row, key) in list" :key="\'list-group-row-\' + key" @click="$emit(\'click\', row.value)"><span v-if="row.icon" class="leading-icon"><i :class="row.icon"></i></span><div class="text"><div class="title">{{row.title}}</div><div v-if="row.subtext" class="subtext">{{row.subtext}}</div></div><span class="trailing-icon"></span></li></ul>',props:{list:{type:Array,required:!0,validator:i=>{for(const t of i){if("string"!=typeof t.title)return!1;if(void 0!==t.subtext&&"string"!=typeof t.subtext)return!1;if(void 0!==t.icon&&"string"!=typeof t.icon)return!1}return!0}}}});
Vue.component("aui-modal",{template:'<div v-if="show" class="aui modal-container" @mousedown.self="handleClose"><div class="modal"><div v-if="title" class="header" :class="modal_class"><h2>{{title}}</h2><i v-if="closeable" class="fas fa-times" @click.self="handleClose"></i></div><div class="body"><slot><section class="content"><slot name="content"/></section><footer><div v-if="$slots.left" class="left"><slot name="left" /></div><div v-if="$slots.right" class="right"><slot name="right" /></div></footer></slot></div></div></div>',props:{type:{type:String,default:"primary",validator:e=>-1!==["none","primary","secondary","success","warning","failure"].indexOf(e)},show:{type:Boolean,required:!0},title:{type:String|Number|null,default:null},closeable:{type:Boolean,default:!0}},computed:{modal_class(){return"none"===this.type?"":"modal-"+this.type}},methods:{escapeClose(e){"Escape"===e.key&&this.handleClose()},handleClose(){this.closeable&&(this.$emit("close"),this.$emit("update:show",!1))},overrides(){this.show&&document.getElementById("ds-nav-container")&&document.getElementById("ds-view-header")?(document.getElementById("ds-nav-container").style.zIndex="0",document.getElementById("ds-view-header").style.zIndex="-1",document.getElementById("ds-nav-container").classList.remove("ds-nav-show-mobile"),document.getElementById("ds-view").style.overflowY="hidden"):!this.show&&document.getElementById("ds-nav-container")&&document.getElementById("ds-view-header")&&(document.getElementById("ds-nav-container").style.zIndex="1",document.getElementById("ds-view-header").style.zIndex="0",document.getElementById("ds-view").style.overflowY="auto")}},watch:{show(){this.overrides()}},mounted(){this.overrides(),this.closeable&&document.addEventListener("keyup",this.escapeClose)},beforeDestroy(){this.closeable&&document.removeEventListener("keyup",this.escapeClose)}});
Vue.component("aui-notice",{template:'<div class="aui notice"><i :class="icon_classes"></i><h4><slot>{{text}}</slot></h4><span v-if="subtext" v-html="subtext"></span></div>',props:{type:{type:String,default:"secondary",validator:t=>-1!==["primary","secondary","success","warning","failure"].indexOf(t)},icon:{type:String,default:"fas fa-cog"},text:{type:String|Number|null,default:null},subtext:{type:String|Number|null,default:null}},computed:{icon_classes(){return{[this.icon]:!0,[this.type]:!0}}}});
Vue.component("aui-number",{template:'<span class="aui number" :class="negative_class">{{pretty_value}}</span>',props:{is_currency:{type:Boolean,default:!1},currency_symbol:{type:String,default:"$"},padding:{type:null|Number,default:null,validator:e=>e>=0&&parseInt(e)===e},number:{type:Number|String|null,required:!0}},computed:{negative_class(){return{negative:parseFloat(this.number.toString().replace(/[^0-9.-]/g,""))<0}},pretty_value(){const e=this.number.toString().replace(/[^0-9.-]/g,""),t=this.is_currency?this.currency_symbol:"",r=parseFloat(e)<0,n=Math.abs(parseInt(e.split(".")[0])).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),a=e.split(".")[1],l=null!==this.padding?this.padding:this.is_currency?2:0;let s=".";return a?s+=a.toString().length<l?a.padEnd(l,"0"):a:s=l>0?s.padEnd(l+1,"0"):"",(r?"-":"")+(t||"")+`${n}${s}`}}});
Vue.component("aui-pagination",{template:'<div class="aui pagination"><div class="range"><label>Showing</label><select :disabled="disabled" @change="updateLimit"><option v-for="limit in list_range_limit" :key="\'page-limit-\' + limit" :value="limit" v-html="limit" /></select><span>from {{from.toLocaleString()}} to {{to.toLocaleString()}} of {{total.toLocaleString()}}</span></div><div v-if="pages>1" class="buttons"><aui-button type="secondary" class="chevron" text="«" :disabled="disabled" @click="paginate(1)" /><aui-button type="secondary" class="chevron" text="‹" :disabled="disabled" @click="paginate(page - 1)" /><aui-button v-for="(page, key) in button_range" :key="\'pagination-\' + key" :type="paginateButtonType(page)" :text="page" :disabled="disabled" class="page-button" @click="paginate(page)" /><aui-button type="secondary" class="chevron" text="›" :disabled="disabled" @click="paginate(page + 1)" /><aui-button type="secondary" class="chevron" text="»" :disabled="disabled" @click="paginate(pages)" /></div><div v-else class="single-page"><strong>1</strong>/<strong>1</strong></div></div>',props:{disabled:{type:Boolean,default:!1},page:{type:Number,required:!0},total:{type:Number,required:!0},limit:{type:Number,required:!0},list_range_limit:{type:Array,required:!0}},computed:{pages(){return Math.ceil(this.total/this.limit)},offset(){let t=(this.page-1)*this.limit;return t>this.total&&(t=this.total-this.limit,this.$emit("update:page",this.pages)),t},from(){return this.offset+1},to(){let t=this.from+this.limit-1;return t>this.total&&(t=this.total),t},button_range(){const t=[];if(this.pages<5)for(let e=1;e<=this.pages;e++)t.push(e);else if(this.page<3)for(let e=1;e<=5;e++)t.push(e);else{const e=this.page+2>this.pages,i=e?this.pages:this.page+2;for(let a=e?this.pages-4:this.page-2;a<=i;a++)t.push(a)}return t}},methods:{updateLimit(t){this.$emit("update:limit",parseInt(t.target.value)),this.$emit("update:page",1),this.$emit("paginate")},paginate(t){this.disabled||t!==this.page&&(t<1||t>this.pages||(this.$emit("update:page",t),this.$emit("paginate")))},paginateButtonType(t){return this.page===parseInt(t)?"primary":"secondary"}}});
Vue.component("aui-radio",{template:'<aui-form-control v-bind="properties"><input type="radio" :name="name" :value="value" :disabled="disabled" @input="$emit(\'input\', $event.target.value)" /></aui-form-control>',props:{label:{type:null|String,default:null},value:{type:String|Number|Boolean|null,default:null},name:{type:String,required:!0},disabled:{type:Boolean,default:!1},success:{type:null|String,default:null},failure:{type:null|String,default:null},subtext:{type:null|String,default:null}},computed:{properties(){return{parent:"radio",label:this.$slots.default?this.$slots.default:this.label,success:this.success,failure:this.failure,subtext:this.subtext}}}});
Vue.component("aui-select",{template:'<aui-form-control v-bind="properties"><select :value="value" :autocomplete="autocomplete" :disabled="disabled" :multiple="multiple" :size="size" @focus="$emit(\'focus\', $event.target)" @blur="$emit(\'blur\', $event.target)" @input="$emit(\'input\', $event.target.value)"><option v-for="(option, key) in render_options" :key="\'option-\' + key" :value="key">{{option}}</option></select></aui-form-control>',props:{label:{type:null|String,default:null},leading_cap:{type:null|String,default:null},trailing_cap:{type:null|String,default:null},value:{type:String|Number|Boolean|null,default:null},autocomplete:{type:null|String,default:null},disabled:{type:Boolean,default:!1},options:{type:Object|Array,default:()=>{}},multiple:{type:Boolean,default:!1},size:{type:String|Number|null,default:null},success:{type:null|String,default:null},failure:{type:null|String,default:null},subtext:{type:null|String,default:null},no_feedback_icon:{type:Boolean,default:!1},us_states:{type:Boolean,default:!1}},data:()=>({states:{0:"",AL:"Alabama",AK:"Alaska",AS:"American Samoa",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FM:"Federated States Of Micronesia",FL:"Florida",GA:"Georgia",GU:"Guam",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MH:"Marshall Islands",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",MP:"Northern Mariana Islands",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PW:"Palau",PA:"Pennsylvania",PR:"Puerto Rico",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VI:"Virgin Islands",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"}}),computed:{properties(){return{parent:"select",label:this.$slots.default?this.$slots.default:this.label,leading_cap:this.leading_cap,trailing_cap:this.trailing_cap,success:this.success,failure:this.failure,subtext:this.subtext,no_feedback_icon:!!this.no_feedback_icon}},render_options(){return this.us_states?this.states:this.options}}});
Vue.component("aui-select-assignment",{template:'<div class="aui select-assignment"><div class="aui select-assigned"><aui-select :label="assigned_label" :options="assigned" :multiple="true" :size="size" :disabled="disabled" v-model="assigned_selected" /><aui-button :text="\'Move to &quot;\' + unassigned_label + \'&quot; list\'" type="secondary" :disabled="disabled" @click="move(\'assigned\')" /></div><div class="aui select-unassigned"><aui-select :label="unassigned_label" :options="unassigned" :multiple="true" :size="size" :disabled="disabled" v-model="unassigned_selected" /><aui-button :text="\'Move to &quot;\' + assigned_label + \'&quot; list\'" type="secondary" :disabled="disabled" @click="move(\'unassigned\')" /></div></div>',props:{assigned:{type:Object|Array|null,required:!0},assigned_label:{type:String,default:"Assigned"},unassigned:{type:null|Object,required:!0},unassigned_label:{type:String,default:"Unassigned"},disabled:{type:Boolean,default:!1},size:{type:String|Number|null,default:5}},data:()=>({assigned_selected:[],unassigned_selected:[]}),methods:{move(e){const s=Object.assign({},this.assigned),i=Object.assign({},this.unassigned);for(const t of this[`${e}_selected`])"assigned"===e?(i[t]=s[t],delete s[t]):(s[t]=i[t],delete i[t]);this.$emit("update:assigned",s),this.$emit("update:unassigned",i),this[`${e}_selected`]=[]}}});
Vue.component("aui-tabs",{template:'<div class="aui tabs"><span v-if="!collapsed" v-for="(name, tab) in tabs" v-html="name" class="tab" :class="tabClass(tab)" @click="handleClick(tab)" /><aui-button-drop v-if="collapsed" :dropdown="tabs" :text="tabs[tab]" @menu-click="handleClick" /></div>',props:{tabs:{type:Object,required:!0},tab:{type:String|Number,required:!0},disabled:{type:Boolean,default:!1}},data:()=>({width:0,collapsed:!1}),methods:{handleClick(e){this.disabled||(this.$emit("update:tab",e),this.$emit("change",e))},tabClass(e){return{disabled:this.disabled,active:e===this.tab}},checkIfCollapsed(){window.requestAnimationFrame(()=>{this.collapsed=this.$el.clientWidth<=this.width||this.width+40>=this.$el.parentElement.clientWidth})}},mounted(){window.addEventListener("resize",this.checkIfCollapsed);for(let e=0;e<this.$el.childNodes.length;e++)"number"==typeof this.$el.childNodes[e].offsetWidth&&(this.width+=this.$el.childNodes[e].offsetWidth+1);this.width=this.width+32,this.checkIfCollapsed()},beforeDestroy(){window.removeEventListener("resize",this.checkIfCollapsed)}});
Vue.component("aui-textarea",{template:'<aui-form-control v-bind="properties"><textarea :value="value" :placeholder="placeholder" :autocomplete="autocomplete" :disabled="disabled" :rows="rows" @focus="$emit(\'focus\', $event.target)" @blur="$emit(\'blur\', $event.target)" @input="$emit(\'input\', $event.target.value)" @keydown="$emit(\'keydown\', $event)" /></aui-form-control>',props:{label:{type:null|String,default:null},leading_cap:{type:null|String,default:null},trailing_cap:{type:null|String,default:null},value:{type:String|Number|Boolean|null,default:null},autocomplete:{type:null|String,default:null},placeholder:{type:null|String,default:null},disabled:{type:Boolean,default:!1},rows:{type:String|Number|null,default:null},success:{type:null|String,default:null},failure:{type:null|String,default:null},subtext:{type:null|String,default:null}},computed:{properties(){return{parent:"textarea",label:this.$slots.default?this.$slots.default:this.label,leading_cap:this.leading_cap,trailing_cap:this.trailing_cap,success:this.success,failure:this.failure,subtext:this.subtext,no_feedback_icon:!!this.no_feedback_icon}}}});
Vue.component("aui-toggle",{template:'<aui-form-control v-bind="properties"><input type="checkbox" :value="value" :checked="toggled" :disabled="disabled" @input="$emit(\'input\', $event.target.checked)" /></aui-form-control>',props:{label:{type:null|String,default:null},value:{type:String|Number|Boolean|null,default:null},toggled:{type:Boolean|Number,default:!1},disabled:{type:Boolean,default:!1},success:{type:null|String,default:null},failure:{type:null|String,default:null},subtext:{type:null|String,default:null}},computed:{properties(){return{parent:"toggle",label:this.$slots.default?this.$slots.default:this.label,success:this.success,failure:this.failure,subtext:this.subtext}}}});
Vue.component("aui-wysiwyg",{template:'<aui-form-control v-bind="properties"><div ref="editor"/></aui-form-control>',props:{label:{type:null|String,default:null},actions:{type:Array,default:()=>["bold","italic","underline","heading1","ulist","olist"]},default_paragraph_separator:{type:String,default:"p"},style_with_css:{type:Boolean,default:!0},classes:{type:Object,default:()=>({actionbar:"pell-actionbar",button:"pell-btn",content:"pell-content",selected:"pell-button-selected"})},value:{type:String|Number|Boolean|null,default:null},placeholder:{type:null|String,default:null},disabled:{type:Boolean,default:!1},success:{type:null|String,default:null},failure:{type:null|String,default:null},subtext:{type:null|String,default:null}},data:()=>({editor:null}),computed:{properties(){return{parent:"wysiwyg",label:this.$slots.default?this.$slots.default:this.label,success:this.success,failure:this.failure,subtext:this.subtext}}},watch:{value:function(t){this.editor.content.innerHTML!==t&&(this.editor.content.innerHTML=t)},disabled:function(t){this.$refs.editor.querySelector(".pell-content").setAttribute("contenteditable",t?"false":"true")}},mounted(){this.editor=pell.init({element:this.$refs.editor,actions:this.actions,defaultParagraphSeparator:this.default_paragraph_separator,styleWithCSS:this.style_with_css,classes:this.classes,onChange:t=>{this.$emit("input",t)}}),this.$refs.editor.querySelector(".pell-content").setAttribute("contenteditable",this.disabled?"false":"true"),this.value&&(this.editor.content.innerHTML=this.value)}});
