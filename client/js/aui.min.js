/*
  Dynamic Suite: AUI
  License: GPLv3
*/
Vue.component("aui-alert",{template:'<div v-if="visible" class="aui alert" :class="container_class"><div><h3 v-if="title">{{title}}</h3><p><slot></slot></p></div><i v-if="closeable" class="fa fa-times close" @click="$emit(\'close\')"></i></div>',props:{type:{type:String,default:"primary",validator:e=>-1!==["none","primary","secondary","success","warning","failure"].indexOf(e)},title:{type:String},visible:{type:Boolean|String,default:!0},closeable:{type:Boolean,default:!1}},computed:{container_class(){return"none"===this.type?"":"alert-"+this.type}}});
Vue.component("aui-badge",{template:'<span class="aui badge" :class="badge_class" v-html="content"></span>',props:{type:{type:String,default:"primary",validator:e=>-1!==["none","primary","secondary","success","warning","failure"].indexOf(e)},content:{type:String|Number,required:!0}},computed:{badge_class(){return"none"===this.type?"":"badge-"+this.type}}});
Vue.component("aui-button",{template:'<button class="aui btn" :class="(type !== \'none\' ? \'btn-\' + type : \'\')" :disabled="is_disabled" @click="$emit(\'click\')"><span v-if="isDelayed()"><i class="fa fa-spin fa-circle-notch"></i><span v-if="has_loading_text" class="loading-text">{{loading_text}}</span><slot v-else></slot></span><slot v-else></slot></button>',props:{type:{type:String,default:"primary",validator:t=>-1!==["primary","secondary","success","warning","failure","none"].indexOf(t)},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loading_text:{type:String,default:null}},data:()=>({show_spinner:!1,default_class:!1}),computed:{has_loading_text(){return"string"==typeof this.loading_text},is_disabled(){return this.loading||this.disabled}},methods:{isDelayed(){return this.loading?setTimeout(()=>{this.loading&&(this.show_spinner=!0)},100):this.show_spinner=!1,this.show_spinner}}});
Vue.component("aui-button-drop",{template:'<div class="aui btn-drop" ref="dropdown"><button class="aui btn" :class="button_classes" :disabled="is_disabled" @click="toggle"><span v-if="$slots.default"><slot></slot></span><i :class="icon_class"></i></button><ul v-show="show_dropdown" class="dropdown" ref="menu" :class="list_classes"><li v-for="entry in dropdown" @click="runAction(entry.action)">{{entry.label}}</li></ul></div>',props:{type:{type:String,default:"primary",validator:t=>-1!==["none","primary","secondary","success","warning","failure"].indexOf(t)},dropdown:{type:Array,required:!0,validator(t){for(let e=0;e<t.length;e++){if("string"!=typeof t[e].label)return!1;if("function"!=typeof t[e].action&&"string"!=typeof t[e].action)return!1}return!0}},disabled:{type:Boolean,default:!1},icon_inactive:{type:String,default:"fas fa-caret-down"},icon_active:{type:String,default:"fas fa-caret-up"},menu_align:{type:String,default:"left",validator:t=>-1!==["left","right"].indexOf(t)},relative_to:{type:null|String,default:null}},computed:{button_classes(){let t={active:this.show_dropdown};return"none"!==this.type&&(t["btn-"+this.type]=!0),t},icon_class(){return this.show_dropdown?this.icon_active:this.icon_inactive},list_classes(){let t={top:this.anchor_top};return t[this.menu_align_master]=!!this.menu_align_master,t[this.menu_align]=!this.menu_align_master,t},is_disabled(){return this.loading||this.disabled}},data:()=>({show_dropdown:!1,anchor_top:!1,menu_align_master:null}),methods:{toggle(){this.show_dropdown=!this.show_dropdown,this.menu_align_master=null,this.anchor_top=!1,Vue.nextTick(()=>{this.$refs.menu.style.opacity="0";const t=this.$refs.menu.getBoundingClientRect();let e=window.innerHeight-t.bottom,i=window.innerWidth-t.right;if(this.relative_to){const n=this.$refs.menu.closest(this.relative_to);n&&(e=n.offsetHeight-t.bottom,i=n.offsetWidth-t.right)}i<0&&(this.menu_align_master="right"),e<0&&(this.anchor_top=!0),this.$refs.menu.style.opacity="1"})},outsideReset(t){this.$refs.dropdown.contains(t.target)||(this.show_dropdown=!1)},runAction(t){"function"==typeof t?t():window.open(t),this.show_dropdown=!1}},created(){window.addEventListener("click",this.outsideReset)},beforeDestroy(){window.removeEventListener("click",this.outsideReset)}});
Vue.component("aui-card",{template:'<div class="aui card" :class="card_class"><h1>{{header}}</h1><div class="body"><h2 v-if="title">{{title}}</h2><p class="card-text"><slot></slot></p></div></div>',props:{type:{type:String,default:"primary",validator:e=>-1!==["none","neutral","primary","secondary","success","warning","failure"].indexOf(e)},header:{type:String,required:!0},title:{type:String}},computed:{card_class(){return"none"===this.type?"":"card-"+this.type}}});
Vue.component("aui-checkbox",{template:'<label class="aui checkbox"><slot></slot><input type="checkbox" :checked="checked" :disabled="disabled" @change="$emit(\'input\', $event.target.checked)"><span class="checkmark"></span></label>',props:{checked:{type:Boolean|Number,default:!1},disabled:{type:Boolean,default:!1}}});
Vue.component("aui-datalist",{template:'<div :id="id + \'-container\'" class="aui datalist"><label><span class="label-text" v-if="label">{{label}}</span><input :id="id" :class="input_classes" :name="name_computed" :type="type" :placeholder="placeholder" :disabled="disabled" :value="value" :list="id + \'-datalist\'" :autocomplete="autocomplete_computed" @keydown="$emit(\'keydown\')" @focus="$emit(\'focus\')" @blur="$emit(\'blur\')" @input="$emit(\'input\', $event.target.value)"><datalist :id="id + \'-datalist\'"><option v-for="option in options" :value="option"></option></datalist></label><div v-if="subtext_value" class="subtext" :class="subtext_classes">{{subtext_value}}</div></div>',props:{id:{type:String,required:!0},label:{type:String},name:{type:String},type:{type:String,default:"text",validator:t=>-1!==["text","number"].indexOf(t)},placeholder:{type:String},disabled:{type:Boolean,default:!1},value:{type:String|Number|Boolean},options:{type:Array|Object,default:[]},success:{type:String|Boolean,default:!1},failure:{type:String|Boolean,default:!1},subtext:{type:String},disable_autofill:{type:Boolean,default:!0}},computed:{input_classes(){return{"border-success":this.success,"border-failure":this.failure}},subtext_classes(){return{"text-success":this.success,"text-failure":this.failure}},subtext_value(){return"string"==typeof this.success?this.success:"string"==typeof this.failure?this.failure:this.subtext},autocomplete_computed(){return this.disable_autofill||"off"===this.autocomplete?"new-password":"on"},name_computed(){return this.disable_autofill?"autofill-disabled-"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15):this.name}},watch:{failure(){clearTimeout(window.aui_failure_timeout),window.aui_failure_timeout=setTimeout(()=>{let t=document.getElementById("ds-view"),e=document.querySelectorAll(".aui .border-failure")[0];if(e){let i=e.getBoundingClientRect(),a=i.top-i.height-100;t.scrollBy({top:a,behavior:"smooth"})}},99)}}});
Vue.component("aui-input",{template:'<div :id="container_id" class="aui input"><div class="scroll-anchor" ref="scrollAnchor"></div><label><span class="label-text" v-if="label">{{label}}</span><span class="input-parent"><span v-if="leading_cap" class="leading-cap" :class="input_classes" v-html="leading_cap"></span><span v-if="trailing_cap" class="trailing-cap" :class="input_classes" v-html="trailing_cap"></span><input :id="id" :class="input_classes" :name="name_computed" :type="type" :placeholder="placeholder" :tabindex="tabindex" :disabled="disabled" :value="value" :step="step" :min="min" :max="max" :autocomplete="autocomplete_computed" ref="input" @keydown="$emit(\'keydown\', $event)" @change="$emit(\'change\', $event.target)" @select="$emit(\'select\', $event.target)" @focus="$emit(\'focus\', $event.target)" @blur="$emit(\'blur\', $event.target)" @input="$emit(\'input\', $event.target.value)" /></span></label><div v-if="subtext_value" class="subtext" :class="subtext_classes">{{subtext_value}}</div></div>',props:{id:{type:String},label:{type:String},leading_cap:{type:String},trailing_cap:{type:String},name:{type:String},type:{type:String,default:"text",validator:e=>-1!==["color","date","datetime-local","email","file","number","password","range","search","tel","text","time","url","week"].indexOf(e)},placeholder:{type:String},tabindex:{type:String|Number},disabled:{type:Boolean,default:!1},value:{type:String|Number|Boolean},step:{type:String|Number},min:{type:String|Number},max:{type:String|Number},autocomplete:{type:String,default:"on",validator:e=>-1!==["on","off"].indexOf(e)},success:{type:String|Boolean,default:!1},failure:{type:String|Boolean,default:!1},subtext:{type:String},no_feedback_icon:{type:Boolean,default:!1},disable_autofill:{type:Boolean,default:!0}},computed:{input_classes(){return{"border-success":this.success,"border-failure":this.failure,"no-feedback-icon":this.no_feedback_icon,"right-cap":this.trailing_cap,"left-cap":this.leading_cap}},subtext_classes(){return{"text-success":this.success,"text-failure":this.failure}},subtext_value(){return"string"==typeof this.success?this.success:"string"==typeof this.failure?this.failure:this.subtext},container_id(){return this.id?this.id+"-container":""},autocomplete_computed(){return this.disable_autofill||"off"===this.autocomplete?"new-password":"on"},name_computed(){return this.disable_autofill?"autofill-disabled-"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15):this.name}},watch:{failure(){clearTimeout(window.aui_failure_timeout),window.aui_failure_timeout=setTimeout(()=>{let e=document.getElementById("ds-view"),t=document.querySelectorAll(".aui .border-failure")[0];if(t){let a=t.getBoundingClientRect(),i=a.top-a.height-100;e.scrollBy({top:i,behavior:"smooth"})}},99)}},methods:{focus(){this.$refs.input.focus()},select(){this.$refs.input.select()}}});
Vue.component("aui-list-group",{template:'<ul class="aui list-group"><li v-for="(row, key) in rows" :key="key" @click="row.action"><span v-if="row.icon" class="leading-icon"><i :class="row.icon"></i></span><div class="text"><div class="title">{{row.title}}</div><div v-if="row.subtext" class="subtext">{{row.subtext}}</div></div><span class="trailing-icon"></span></li></ul>',props:{rows:{type:Array,required:!0,validator(t){for(let i=0;i<t.length;i++){if("string"!=typeof t[i].title)return!1;if(null!==t[i].subtext&&"string"!=typeof t[i].subtext)return!1;if("function"!=typeof t[i].action)return!1;if(void 0!==t[i].icon&&"string"!=typeof t[i].subtext)return!1}return!0}}}});
Vue.component("aui-modal",{template:'<div v-if="show" class="aui modal-container" @mousedown.self="runClose"><div class="modal"><div v-if="title" class="header" :class="modal_class"><h2>{{title}}</h2><i v-if="closeable" class="fas fa-times" @click.self="runClose"></i></div><div class="body"><slot></slot></div></div></div>',props:{type:{type:String,default:"primary",validator:e=>-1!==["none","primary","secondary","success","warning","failure"].indexOf(e)},show:{type:Boolean,required:!0},title:{type:String},closeable:{type:Boolean,default:!0}},computed:{modal_class(){return"none"===this.type?"":"modal-"+this.type}},methods:{escapeClose(e){"Escape"===e.key&&this.runClose()},runClose(){if(!this.closeable)return!1;this.$emit("close")}},watch:{show(){this.show&&document.getElementById("ds-nav-container")&&document.getElementById("ds-view-header")?(document.getElementById("ds-nav-container").style.zIndex="0",document.getElementById("ds-view-header").style.zIndex="-1",document.getElementById("ds-nav-container").classList.remove("ds-nav-show-mobile"),document.getElementById("ds-view").style.overflowY="hidden"):!this.show&&document.getElementById("ds-nav-container")&&document.getElementById("ds-view-header")&&(document.getElementById("ds-nav-container").style.zIndex="1",document.getElementById("ds-view-header").style.zIndex="0",document.getElementById("ds-view").style.overflowY="auto")}},created(){this.closeable&&document.addEventListener("keyup",this.escapeClose)},beforeDestroy(){this.closeable&&document.removeEventListener("keyup",this.escapeClose)}});
Vue.component("aui-notice",{template:'<div class="aui notice"><i :class="icon_classes"></i><h4><slot></slot></h4><span v-if="subtext" v-html="subtext"></span></div>',props:{type:{type:String,default:"secondary",validator:t=>-1!==["primary","secondary","success","warning","failure"].indexOf(t)},icon:{type:String,default:"fas fa-cog"},subtext:{type:null|String,default:null}},computed:{icon_classes(){let t={};return t[this.icon]=!0,t[this.type]=!0,t}}});
Vue.component("aui-number",{template:'<span class="aui number" :class="negative_class">{{pretty_value}}</span>',props:{is_currency:{type:Boolean,default:!1},currency_symbol:{type:String,default:"$"},padding:{type:null|Number,default:null,validator:t=>t>=0&&parseInt(t)===t}},computed:{negative_class(){return{negative:parseFloat(this.$slots.default[0].text.replace(/[^0-9.-]/g,""))<0}},pretty_value(){const t=this.$slots.default[0].text.replace(/[^0-9.-]/g,""),e=this.is_currency?this.currency_symbol:"",a=parseFloat(t)<0,s=Math.abs(parseInt(t.split(".")[0])).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),l=parseInt(t.split(".")[1]),n=null!==this.padding?this.padding:this.is_currency?2:0;let r=".";return isNaN(l)?r=n>0?r.padEnd(n+1,"0"):"":r+=l.toString().length<n?l.padEnd(n+1,"0"):l,(a?"-":"")+(e||"")+`${s}${r}`}}});
Vue.component("aui-radio",{template:'<label class="aui radio"><slot></slot><input type="radio" :name="group" :value="data" @change="$emit(\'input\', $event.target.value)"><span class="bubble"></span></label>',props:{group:{type:String,required:!0},data:{type:String|Number|Boolean}}});
Vue.component("aui-select",{template:'<div :id="container_id" class="aui select"><label><span class="label-text" v-if="label">{{label}}</span><select :id="id" :class="input_classes" :name="name_computed" :disabled="disabled" :value="value" :autocomplete="autocomplete_computed" @input="$emit(\'input\', $event.target.value)" @change="$emit(\'change\', $event.target.value)"><option v-for="(option, value) in render_options" :value="value">{{option}}</option></select></label><div v-if="subtext_value" class="subtext" :class="subtext_classes">{{subtext_value}}</div></div>',props:{id:{type:String},label:{type:String},name:{type:String},disabled:{type:Boolean,default:!1},value:{type:String|Number|Boolean},options:{type:Array|Object},success:{type:String|Boolean,default:!1},failure:{type:String|Boolean,default:!1},subtext:{type:String},us_states:{type:Boolean,default:!1},no_feedback_icon:{type:Boolean,default:!1},disable_autofill:{type:Boolean,default:!0}},data:()=>({states:{0:"",AL:"Alabama",AK:"Alaska",AS:"American Samoa",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FM:"Federated States Of Micronesia",FL:"Florida",GA:"Georgia",GU:"Guam",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MH:"Marshall Islands",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",MP:"Northern Mariana Islands",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PW:"Palau",PA:"Pennsylvania",PR:"Puerto Rico",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VI:"Virgin Islands",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"}}),computed:{render_options(){return this.us_states?this.states:this.options},input_classes(){return{"border-success":this.success,"border-failure":this.failure,"no-feedback-icon":this.no_feedback_icon}},subtext_classes(){return{"text-success":this.success,"text-failure":this.failure}},subtext_value(){return"string"==typeof this.success?this.success:"string"==typeof this.failure?this.failure:this.subtext},container_id(){return this.id?this.id+"-container":""},autocomplete_computed(){return this.disable_autofill||"off"===this.autocomplete?"new-password":"on"},name_computed(){return this.disable_autofill?"autofill-disabled-"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15):this.name}},watch:{failure(){clearTimeout(window.aui_failure_timeout),window.aui_failure_timeout=setTimeout(()=>{let e=document.getElementById("ds-view"),t=document.querySelectorAll(".aui .border-failure")[0];if(t){let a=t.getBoundingClientRect(),i=a.top-a.height-100;e.scrollBy({top:i,behavior:"smooth"})}},99)}}});
Vue.component("aui-table",{template:'<div class="aui table"><table><thead v-if="show_headers"><tr><th v-for="header in columns">{{header}}</th></tr></thead><tbody><tr v-for="row in rows"><td v-if="columns[column]" v-for="(value, column) in row">{{value}}</td></tr><tr v-if="no_data"><td class="no-data" :colspan="column_count">No rows in dataset</td></tr></tbody></table></div>',props:{columns:{type:Object,required:!0},show_headers:{type:Boolean,default:!0},rows:{type:Array,required:!0}},computed:{no_data(){return 0===this.rows.length},column_count(){return Object.keys(this.columns).length}}});
Vue.component("aui-tabs",{template:'<div class="aui tabs"><span v-if="!collapsed" v-for="tab in tab_structure" class="tab" :class="tabClass(tab.id)" @click="tab.action">{{tab.label}}</span><aui-button-drop v-if="collapsed" :dropdown="tab_structure">{{tab_name}}</aui-button-drop></div>',props:{tabs:{type:Object,required:!0},initial_tab:{type:String,default:null}},data:()=>({width:0,collapsed:!1,tab:null}),computed:{tab_structure(){let t=[],e=Object.keys(this.tabs);for(let i=0;i<e.length;i++){let s=e[i];t[i]={id:s,label:this.tabs[s],action:()=>{this.tab=s,this.$emit("change",this.tab)}}}return t},tab_name(){return this.tabs[this.tab]}},methods:{checkIfCollapsed(){window.requestAnimationFrame(()=>{this.collapsed=this.$el.clientWidth<=this.width||this.$el.clientWidth+40>=window.innerWidth})},tabClass(t){return{active:this.tab===t}}},created(){window.addEventListener("resize",this.checkIfCollapsed)},mounted(){for(let t=0;t<this.$el.childNodes.length;t++)"number"==typeof this.$el.childNodes[t].offsetWidth&&(this.width+=this.$el.childNodes[t].offsetWidth+1);this.width=this.width+32,this.checkIfCollapsed(),this.initial_tab?this.tab=this.initial_tab:this.tab=Object.keys(this.tabs)[0]},watch:{initial_tab(t){this.tab=t}},beforeDestroy(){window.removeEventListener("resize",this.checkIfCollapsed)}});
Vue.component("aui-textarea",{template:'<div :id="container_id" class="aui textarea"><label><span class="label-text" v-if="label">{{label}}</span><textarea :id="id" :class="input_classes" :name="name_computed" :type="type" :placeholder="placeholder" :disabled="disabled" :value="value" ref="textarea" @keydown="$emit(\'keydown\', $event)" @change="$emit(\'change\', $event.target)" @select="$emit(\'select\', $event.target)" @focus="$emit(\'focus\', $event.target)" @blur="$emit(\'blur\', $event.target)" @input="$emit(\'input\', $event.target.value)" /></label><div v-if="subtext_value" class="subtext" :class="subtext_classes">{{subtext_value}}</div></div>',props:{id:{type:String},label:{type:String},name:{type:String},type:{type:String,default:"text",validator:e=>-1!==["color","date","datetime-local","email","file","number","password","range","search","tel","text","time","url","week"].indexOf(e)},placeholder:{type:String},disabled:{type:Boolean,default:!1},value:{type:String|Number|Boolean},success:{type:String|Boolean,default:!1},failure:{type:String|Boolean,default:!1},subtext:{type:String}},computed:{input_classes(){return{"border-success":this.success,"border-failure":this.failure,"no-feedback-icon":this.no_feedback_icon,"right-cap":this.trailing_cap,"left-cap":this.leading_cap}},subtext_classes(){return{"text-success":this.success,"text-failure":this.failure}},subtext_value(){return"string"==typeof this.success?this.success:"string"==typeof this.failure?this.failure:this.subtext},container_id(){return this.id?this.id+"-container":""},name_computed(){return this.disable_autofill?"autofill-disabled-"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15):this.name}},watch:{failure(){clearTimeout(window.aui_failure_timeout),window.aui_failure_timeout=setTimeout(()=>{let e=document.getElementById("ds-view"),t=document.querySelectorAll(".aui .border-failure")[0];if(t){let i=t.getBoundingClientRect(),a=i.top-i.height-100;e.scrollBy({top:a,behavior:"smooth"})}},99)}},methods:{focus(){this.$refs.input.focus()},select(){this.$refs.input.select()}}});
Vue.component("aui-toggle",{template:'<label class="aui toggle"><span class="label-text">{{label}}</span><span class="switch"><input type="checkbox" :checked="toggled" :disabled="disabled" @change="$emit(\'input\', $event.target.checked)"><span class="slider"></span></span></label>',props:{toggled:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},label:{type:null|String,default:null}}});
Vue.component("aui-wysiwyg",{template:'<div :id="id + \'-container\'" class="aui wysiwyg"><label>{{label}}</label><div :id="id"></div></div>',props:{id:{type:String,required:!0},label:{type:String},text:{type:String,default:""}},data:()=>({editor:null}),mounted(){this.editor=pell.init({element:document.getElementById(this.id),defaultParagraphSeparator:"p",styleWithCSS:!0,onChange:t=>{this.$emit("input",t)},actions:["bold","italic","underline","heading1","ulist","olist"],classes:{actionbar:"pell-actionbar",button:"pell-btn",content:"pell-content",selected:"pell-button-selected"}}),this.editor.content.innerHTML=this.text},watch:{text(){""===this.editor.content.innerHTML&&(this.editor.content.innerHTML=this.text)}}});
